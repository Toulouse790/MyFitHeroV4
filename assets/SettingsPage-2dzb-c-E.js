import{d as ae,r as o,f as d,j as e,u as Fe,e as Be}from"./index-CjnEZlsY.js";import{u as ve}from"./use-toast-1UJezmcI.js";import{e as Z,u as ye,B as C,C as A,c as q,a as L,b as V,f as Q,d as Le}from"./badge-0XDKnG36.js";import{I as z}from"./input-BbNGe5Ek.js";import{b as Ve,c as Ge,P as je,e as We}from"./index-DdwsCUG1.js";import{a as $e,u as Je}from"./index-Dxu7zm8J.js";import{T as Qe,a as Ke,b as Xe,c as G}from"./tabs-jX3VcdfO.js";import{a as Ze,T as Ye}from"./textarea-C4XsJauq.js";import{U as Ue,B as es}from"./UniformHeader-CjBBS_mR.js";import{U}from"./user-BtYr8gLe.js";import{S as ss}from"./shield-BlXCgQw2.js";import{S as K}from"./save-T82v-oun.js";import{C as ts}from"./clock-Dl80stQh.js";import{C as he}from"./circle-alert-T1ygxnjL.js";import{H as as}from"./heart-Cxo5znlq.js";import{R as ee}from"./refresh-cw-CxIxu3Pr.js";import{A as se}from"./activity-C-flMYAi.js";import{E as rs}from"./eye-CSV1oSLp.js";import{C as is}from"./circle-check-big-B5HpQEAC.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],pe=ae("globe",ns);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],fe=ae("palette",os);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],ge=ae("smartphone",ls),cs=()=>{const[y,r]=o.useState(!1),[a,s]=o.useState(null),[i,l]=o.useState(null),{toast:n}=ve(),u=o.useCallback(()=>{var c;return typeof window<"u"&&window.webkit&&((c=window.webkit.messageHandlers)==null?void 0:c.healthKit)},[]),m=o.useCallback(()=>{var c;return typeof window<"u"&&window.gapi&&((c=window.gapi.client)==null?void 0:c.fitness)},[]),f=o.useCallback(async()=>{if(!u())return l("Apple Health n'est pas disponible sur cet appareil"),null;try{r(!0),l(null),await new Promise(h=>setTimeout(h,2e3));const c={steps:Math.floor(Math.random()*1e4)+5e3,heartRate:Array.from({length:10},()=>Math.floor(Math.random()*40)+60),sleepSessions:[{id:"1",startTime:new Date(Date.now()-8*60*60*1e3),endTime:new Date(Date.now()-30*60*1e3),duration:450,quality:"good",deepSleepDuration:120,remSleepDuration:90,awakenings:2}],lastSync:new Date,caloriesBurned:Math.floor(Math.random()*500)+200,distance:Math.floor(Math.random()*5e3)+2e3,activeMinutes:Math.floor(Math.random()*120)+30};return s(new Date),n({title:"Synchronisation r√©ussie",description:"Donn√©es Apple Health synchronis√©es avec succ√®s",variant:"default"}),c}catch{const c=error instanceof Error?error.message:"Erreur de synchronisation Apple Health";return l(c),n({title:"Erreur de synchronisation",description:c,variant:"destructive"}),null}finally{r(!1)}},[u,n]),g=o.useCallback(async()=>{if(!m())return l("Google Fit n'est pas disponible sur cet appareil"),null;try{r(!0),l(null),await new Promise(h=>setTimeout(h,2e3));const c={steps:Math.floor(Math.random()*12e3)+4e3,heartRate:Array.from({length:12},()=>Math.floor(Math.random()*45)+55),sleepSessions:[{id:"2",startTime:new Date(Date.now()-9*60*60*1e3),endTime:new Date(Date.now()-60*60*1e3),duration:480,quality:"excellent",deepSleepDuration:150,remSleepDuration:110,awakenings:1}],lastSync:new Date,caloriesBurned:Math.floor(Math.random()*600)+300,distance:Math.floor(Math.random()*6e3)+3e3,activeMinutes:Math.floor(Math.random()*150)+45};return s(new Date),n({title:"Synchronisation r√©ussie",description:"Donn√©es Google Fit synchronis√©es avec succ√®s",variant:"default"}),c}catch{const c=error instanceof Error?error.message:"Erreur de synchronisation Google Fit";return l(c),n({title:"Erreur de synchronisation",description:c,variant:"destructive"}),null}finally{r(!1)}},[m,n]),x=o.useCallback(async()=>{const c=await Promise.allSettled([f(),g()]),h=c[0],p=c[1];if(h.status==="fulfilled"&&p.status==="fulfilled"){const v=h.value,w=p.value;if(v&&w)return{steps:Math.max(v.steps,w.steps),heartRate:[...v.heartRate,...w.heartRate],sleepSessions:[...v.sleepSessions,...w.sleepSessions],lastSync:new Date,caloriesBurned:Math.max(v.caloriesBurned||0,w.caloriesBurned||0),distance:Math.max(v.distance||0,w.distance||0),activeMinutes:Math.max(v.activeMinutes||0,w.activeMinutes||0)}}return h.status==="fulfilled"&&h.value?h.value:p.status==="fulfilled"&&p.value?p.value:null},[f,g]),S=o.useCallback((c=30)=>{const h=setInterval(async()=>{try{await x()}catch{console.error("Erreur lors de la synchronisation programm√©e:",error)}},c*60*1e3);return()=>clearInterval(h)},[x]),D=o.useCallback(()=>{try{const c=localStorage.getItem("wearableData");if(c){const h=JSON.parse(c);return{...h,lastSync:new Date(h.lastSync),sleepSessions:h.sleepSessions.map(p=>({...p,startTime:new Date(p.startTime),endTime:new Date(p.endTime)}))}}}catch{console.error("Erreur lors de la lecture des donn√©es mises en cache:",error)}return null},[]),k=o.useCallback(c=>{try{localStorage.setItem("wearableData",JSON.stringify(c))}catch{console.error("Erreur lors de la sauvegarde des donn√©es en cache:",error)}},[]);return{isLoading:y,lastSyncTime:a,syncError:i,isAppleHealthAvailable:u(),isGoogleFitAvailable:m(),syncAppleHealth:f,syncGoogleFit:g,syncAll:x,scheduleSync:S,getCachedData:D,cacheData:k}};class xe{static async updateLastLogin(r){const{error:a}=await d.from("user_profiles").update({last_login:new Date().toISOString()}).eq("id",r);a&&console.error("Erreur mise √† jour login:",a)}static async getHighConfidenceRecommendations(r,a=.8){const{data:s,error:i}=await d.from("ai_recommendations").select("*").eq("user_id",r).gte("confidence_score",a).eq("is_applied",!1).order("confidence_score",{ascending:!1});return{data:s,error:i}}static async getPopularWorkoutTemplates(r=10){const{data:a,error:s}=await d.from("workouts").select("*, user_profiles(username)").eq("is_template",!0).order("created_at",{ascending:!1}).limit(r);return{data:a,error:s}}static async getFoodByBarcode(r){const{data:a,error:s}=await d.from("foods_library").select("*").eq("barcode",r).single();return{data:a,error:s}}static async analyzeSleepPatterns(r,a=30){const{data:s,error:i}=await d.from("sleep_sessions").select("*").eq("user_id",r).gte("sleep_date",new Date(Date.now()-a*24*60*60*1e3).toISOString()).order("sleep_date",{ascending:!1});return s?{data:s.map(n=>{var u;return{date:n.sleep_date,quality:n.quality_rating,duration:n.duration_minutes,stages:n.sleep_stage_data,deepSleepPercentage:((u=n.sleep_stage_data)==null?void 0:u.deep_sleep_minutes)/n.duration_minutes*100}}),error:null}:{data:null,error:i}}static async getHydrationPatterns(r,a=7){const{data:s,error:i}=await d.from("hydration_logs").select("*").eq("user_id",r).gte("log_date",new Date(Date.now()-a*24*60*60*1e3).toISOString()).order("logged_at",{ascending:!0});return s?{data:s.reduce((n,u)=>{const m=u.hydration_context;return n[m]||(n[m]={total:0,count:0,average:0}),n[m].total+=u.amount_ml,n[m].count+=1,n[m].average=n[m].total/n[m].count,n},{}),error:null}:{data:null,error:i}}static async updateGoalProgress(r,a){const{data:s,error:i}=await d.from("user_goals").select("*").eq("id",r).single();if(i||!s)return{error:i};const l=s.progress_history||[],n={date:new Date().toISOString(),value:a,percentage:a/s.target_value*100},u=[...l,n],{error:m}=await d.from("user_goals").update({current_value:a,progress_history:u,achieved_at:a>=s.target_value?new Date().toISOString():null}).eq("id",r);return{error:m}}static async checkPremiumAccess(r){const{data:a,error:s}=await d.from("user_profiles").select("subscription_status").eq("id",r).single();return s?{hasPremium:!1,status:"free"}:{hasPremium:["premium","pro","enterprise"].includes(a.subscription_status),status:a.subscription_status}}static async uploadMealPhoto(r,a){const s=`meals/${r}/${Date.now()}_${a.name}`,{error:i}=await d.storage.from("meal-photos").upload(s,a);if(i)return{error:i};const{data:l}=d.storage.from("meal-photos").getPublicUrl(s),{error:n}=await d.from("meals").update({meal_photo_url:l.publicUrl}).eq("id",r);return{error:n,url:l.publicUrl}}static async createAIRequest(r,a,s,i="app",l){const{data:n,error:u}=await d.from("ai_requests").insert({user_id:r,pillar_type:a,prompt:s,source:i,context:l,status:"pending"}).select().single();return{data:n,error:u}}static async saveWearableSteps(r,a,s=new Date){const{error:i}=await d.from("wearable_steps").upsert({user_id:r,steps:a,date:s.toISOString().split("T")[0],synced_at:new Date().toISOString()},{onConflict:"user_id, date"});return i&&console.error("Erreur sauvegarde steps:",i),{error:i}}static async saveHeartRateData(r,a,s=new Date){const i=a.map(n=>({user_id:r,heart_rate:n,recorded_at:s.toISOString(),synced_at:new Date().toISOString()})),{error:l}=await d.from("heart_rate_logs").insert(i);return l&&console.error("Erreur sauvegarde heart rate:",l),{error:l}}static async saveSleepSession(r,a){const{error:s}=await d.from("sleep_sessions").insert({user_id:r,start_time:a.startTime.toISOString(),end_time:a.endTime.toISOString(),duration_minutes:a.duration,quality_score:a.quality,deep_sleep_minutes:a.deepSleepDuration,rem_sleep_minutes:a.remSleepDuration,awakenings_count:a.awakenings,synced_at:new Date().toISOString()});return s&&console.error("Erreur sauvegarde sleep session:",s),{error:s}}static async saveWearableWorkout(r,a){const{error:s}=await d.from("wearable_workouts").insert({user_id:r,workout_type:a.type,start_time:a.startTime.toISOString(),end_time:a.endTime.toISOString(),calories_burned:a.calories,distance_meters:a.distance,data_source:a.source,synced_at:new Date().toISOString()});return s&&console.error("Erreur sauvegarde wearable workout:",s),{error:s}}static async getWearableSteps(r,a,s){const{data:i,error:l}=await d.from("wearable_steps").select("*").eq("user_id",r).gte("date",a.toISOString().split("T")[0]).lte("date",s.toISOString().split("T")[0]).order("date",{ascending:!0});return{data:i,error:l}}static async getHeartRateData(r,a,s){const{data:i,error:l}=await d.from("heart_rate_logs").select("*").eq("user_id",r).gte("recorded_at",a.toISOString()).lte("recorded_at",s.toISOString()).order("recorded_at",{ascending:!0});return{data:i,error:l}}static async getSleepSessions(r,a,s){const{data:i,error:l}=await d.from("sleep_sessions").select("*").eq("user_id",r).gte("start_time",a.toISOString()).lte("end_time",s.toISOString()).order("start_time",{ascending:!0});return{data:i,error:l}}static async getWearableWorkouts(r,a,s){const{data:i,error:l}=await d.from("wearable_workouts").select("*").eq("user_id",r).gte("start_time",a.toISOString()).lte("end_time",s.toISOString()).order("start_time",{ascending:!0});return{data:i,error:l}}static async getWearableStats(r,a=7){const s=new Date,i=new Date(s.getTime()-a*24*60*60*1e3),[l,n,u]=await Promise.allSettled([this.getWearableSteps(r,i,s),this.getHeartRateData(r,i,s),this.getSleepSessions(r,i,s)]),m={totalSteps:0,avgHeartRate:0,avgSleepDuration:0,avgSleepQuality:0,totalWorkouts:0,lastSync:null};if(l.status==="fulfilled"&&l.value.data&&(m.totalSteps=l.value.data.reduce((f,g)=>f+g.steps,0)),n.status==="fulfilled"&&n.value.data){const f=n.value.data;f.length>0&&(m.avgHeartRate=f.reduce((g,x)=>g+x.heart_rate,0)/f.length)}if(u.status==="fulfilled"&&u.value.data){const f=u.value.data;if(f.length>0){m.avgSleepDuration=f.reduce((x,S)=>x+S.duration_minutes,0)/f.length;const g=f.map(x=>{switch(x.quality_score){case"excellent":return 4;case"good":return 3;case"fair":return 2;case"poor":return 1;default:return 2}});m.avgSleepQuality=g.reduce((x,S)=>x+S,0)/g.length}}return m}}const b=o.forwardRef(({className:y,...r},a)=>e.jsx("label",{ref:a,className:Z("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",y),...r}));b.displayName="Label";var Y="Switch",[ds,As]=Ge(Y),[us,ms]=ds(Y),be=o.forwardRef((y,r)=>{const{__scopeSwitch:a,name:s,checked:i,defaultChecked:l,required:n,disabled:u,value:m="on",onCheckedChange:f,form:g,...x}=y,[S,D]=o.useState(null),k=ye(r,w=>D(w)),c=o.useRef(!1),h=S?g||!!S.closest("form"):!0,[p,v]=Ve({prop:i,defaultProp:l??!1,onChange:f,caller:Y});return e.jsxs(us,{scope:a,checked:p,disabled:u,children:[e.jsx(je.button,{type:"button",role:"switch","aria-checked":p,"aria-required":n,"data-state":Ne(p),"data-disabled":u?"":void 0,disabled:u,value:m,...x,ref:k,onClick:We(y.onClick,w=>{v(W=>!W),h&&(c.current=w.isPropagationStopped(),c.current||w.stopPropagation())})}),h&&e.jsx(Se,{control:S,bubbles:!c.current,name:s,value:m,checked:p,required:n,disabled:u,form:g,style:{transform:"translateX(-100%)"}})]})});be.displayName=Y;var we="SwitchThumb",_e=o.forwardRef((y,r)=>{const{__scopeSwitch:a,...s}=y,i=ms(we,a);return e.jsx(je.span,{"data-state":Ne(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:r})});_e.displayName=we;var hs="SwitchBubbleInput",Se=o.forwardRef(({__scopeSwitch:y,control:r,checked:a,bubbles:s=!0,...i},l)=>{const n=o.useRef(null),u=ye(n,l),m=$e(a),f=Je(r);return o.useEffect(()=>{const g=n.current;if(!g)return;const x=window.HTMLInputElement.prototype,D=Object.getOwnPropertyDescriptor(x,"checked").set;if(m!==a&&D){const k=new Event("click",{bubbles:s});D.call(g,a),g.dispatchEvent(k)}},[m,a,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:u,style:{...i.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Se.displayName=hs;function Ne(y){return y?"checked":"unchecked"}var Ce=be,ps=_e;const X=o.forwardRef(({className:y,...r},a)=>e.jsx(Ce,{className:Z("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",y),...r,ref:a,children:e.jsx(ps,{className:Z("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));X.displayName=Ce.displayName;const te=o.forwardRef(({className:y,orientation:r="horizontal",decorative:a=!0,...s},i)=>e.jsx("div",{ref:i,role:a?"none":"separator","aria-orientation":a?void 0:r,className:Z("shrink-0 bg-gray-200",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",y),...s}));te.displayName="Separator";const fs=()=>{var ue;const[y,r]=Fe(),{toast:a}=ve(),{appStoreUser:s,setAppStoreUser:i,clearStore:l}=Be(),{isLoading:n,lastSyncTime:u,syncError:m,isAppleHealthAvailable:f,isGoogleFitAvailable:g,syncAppleHealth:x,syncGoogleFit:S,syncAll:D,scheduleSync:k,getCachedData:c,cacheData:h}=cs(),[p,v]=o.useState(!1),[w,W]=o.useState("profile"),[M,re]=o.useState(!1),[O,ie]=o.useState(30),[H,$]=o.useState(null),[ne,oe]=o.useState(!1),[j,I]=o.useState({full_name:(s==null?void 0:s.full_name)||"",username:(s==null?void 0:s.username)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",bio:(s==null?void 0:s.bio)||"",city:(s==null?void 0:s.city)||"",country:(s==null?void 0:s.country)||""}),[T,le]=o.useState({workout_reminders:!0,hydration_reminders:!0,meal_reminders:!0,sleep_reminders:!0,achievement_alerts:!0,weekly_summary:!0,marketing_emails:!1}),[R,ce]=o.useState({profile_public:!1,share_stats:!1,allow_friend_requests:!0,show_activity:!0}),[N,F]=o.useState({language:"fr",theme:"light",units:"metric",currency:"EUR"}),De=o.useCallback(async()=>{if(!(s!=null&&s.id)||!window.confirm(`‚ö†Ô∏è ATTENTION : Vous √™tes sur le point de supprimer d√©finitivement votre compte MyFitHero.

Cette action supprimera :
- Votre profil et toutes vos donn√©es personnelles
- Tout votre historique d'entra√Ænements
- Vos statistiques et progressions
- Vos donn√©es de nutrition et hydratation
- Vos connexions sociales

√ätes-vous absolument certain de vouloir continuer ?`)||!window.confirm(`üö® DERNI√àRE CHANCE

Tapez 'SUPPRIMER' dans la prochaine bo√Æte de dialogue pour confirmer la suppression d√©finitive de votre compte.`))return;if(window.prompt("Pour confirmer la suppression d√©finitive, tapez exactement : SUPPRIMER")!=="SUPPRIMER"){a({title:"Suppression annul√©e",description:"La suppression de votre compte a √©t√© annul√©e."});return}oe(!0);try{const P=s.id,J=["user_workouts","user_nutrition","user_hydration","user_sleep","user_analytics","user_preferences","user_social_connections","user_achievements","user_wearable_data","user_profiles"];for(const B of J){const{error:me}=await d.from(B).delete().eq("user_id",P);me&&console.warn(`Erreur suppression ${B}:`,me)}const{error:He}=await d.auth.admin.deleteUser(P);if(He){const{error:B}=await d.rpc("delete_user_account",{user_id:P});if(B)throw new Error("Impossible de supprimer le compte: "+B.message)}l(),localStorage.clear(),sessionStorage.clear(),typeof window<"u"&&window.gtag&&window.gtag("event","account_deleted",{user_id:P,timestamp:new Date().toISOString()}),await d.auth.signOut(),a({title:"Compte supprim√©",description:"Votre compte MyFitHero a √©t√© d√©finitivement supprim√©. Nous esp√©rons vous revoir bient√¥t !",duration:5e3}),setTimeout(()=>{r("/goodbye")},2e3)}catch{console.error("Erreur suppression compte:",error),a({title:"Erreur de suppression",description:"Une erreur est survenue lors de la suppression. Contactez le support si le probl√®me persiste.",variant:"destructive",duration:8e3})}finally{oe(!1)}},[s==null?void 0:s.id,l,r,a]),de=o.useCallback(async()=>{if(s!=null&&s.id)try{const{data:t,error:E}=await d.from("user_preferences").select("*").eq("user_id",s.id).single();!E&&t&&(le(t.notifications||T),ce(t.privacy||R),F(t.app_preferences||N));const _=c();_&&$(_);const P=localStorage.getItem("autoSyncEnabled"),J=localStorage.getItem("syncInterval");P&&re(JSON.parse(P)),J&&ie(parseInt(J))}catch{console.error("Erreur chargement param√®tres:",error)}},[s==null?void 0:s.id,c,T,R,N]),Ee=o.useCallback(async()=>{if(s!=null&&s.id){v(!0);try{const{error:t}=await d.from("user_profiles").update({...j,updated_at:new Date().toISOString()}).eq("id",s.id);if(t)throw t;i({...s,...j}),a({title:"Profil mis √† jour",description:"Vos informations ont √©t√© sauvegard√©es avec succ√®s."}),typeof window<"u"&&window.gtag&&window.gtag("event","profile_updated",{user_id:s.id,section:"settings"})}catch{console.error("Erreur sauvegarde profil:",error),a({title:"Erreur",description:"Impossible de sauvegarder le profil.",variant:"destructive"})}finally{v(!1)}}},[s,j,i,a]),ke=o.useCallback(async()=>{if(s!=null&&s.id){v(!0);try{const{error:t}=await d.from("user_preferences").upsert({user_id:s.id,notifications:T,updated_at:new Date().toISOString()},{onConflict:"user_id",ignoreDuplicates:!1});if(t)throw t;a({title:"Notifications mises √† jour",description:"Vos pr√©f√©rences de notification ont √©t√© sauvegard√©es."})}catch{console.error("Erreur sauvegarde notifications:",error),a({title:"Erreur",description:"Impossible de sauvegarder les notifications.",variant:"destructive"})}finally{v(!1)}}},[s==null?void 0:s.id,T,a]),Ie=o.useCallback(async()=>{if(s!=null&&s.id){v(!0);try{const{error:t}=await d.from("user_preferences").upsert({user_id:s.id,app_preferences:N,updated_at:new Date().toISOString()},{onConflict:"user_id",ignoreDuplicates:!1});if(t)throw t;a({title:"Pr√©f√©rences mises √† jour",description:"Vos pr√©f√©rences d'application ont √©t√© sauvegard√©es."})}catch{console.error("Erreur sauvegarde pr√©f√©rences:",error),a({title:"Erreur",description:"Impossible de sauvegarder les pr√©f√©rences.",variant:"destructive"})}finally{v(!1)}}},[s==null?void 0:s.id,N,a]),Pe=o.useCallback(async()=>{if(s!=null&&s.id){v(!0);try{const{error:t}=await d.from("user_preferences").upsert({user_id:s.id,privacy:R,updated_at:new Date().toISOString()},{onConflict:"user_id",ignoreDuplicates:!1});if(t)throw t;a({title:"Confidentialit√© mise √† jour",description:"Vos param√®tres de confidentialit√© ont √©t√© sauvegard√©s."})}catch{console.error("Erreur sauvegarde confidentialit√©:",error),a({title:"Erreur",description:"Impossible de sauvegarder la confidentialit√©.",variant:"destructive"})}finally{v(!1)}}},[s==null?void 0:s.id,R,a]),Me=o.useCallback(async()=>{const t=await x();t&&(s!=null&&s.id)&&(h(t),$(t),t.steps&&await xe.saveWearableSteps(s.id,t.steps),t.heartRate&&t.heartRate.length>0&&await xe.saveHeartRateData(s.id,t.heartRate),a({title:"Apple Health synchronis√©",description:"Vos donn√©es ont √©t√© mises √† jour."}))},[x,h,s==null?void 0:s.id,a]),Te=o.useCallback(async()=>{const t=await S();t&&(s!=null&&s.id)&&(h(t),$(t),a({title:"Google Fit synchronis√©",description:"Vos donn√©es ont √©t√© mises √† jour."}))},[S,h,s==null?void 0:s.id,a]),Re=o.useCallback(async()=>{const t=await D();t&&(s!=null&&s.id)&&(h(t),$(t),a({title:"Synchronisation compl√®te",description:"Tous vos appareils ont √©t√© synchronis√©s."}))},[D,h,s==null?void 0:s.id,a]),Ae=o.useCallback(()=>{const t=!M;re(t),localStorage.setItem("autoSyncEnabled",JSON.stringify(t)),a({title:t?"Auto-sync activ√©":"Auto-sync d√©sactiv√©",description:t?`Synchronisation toutes les ${O} minutes`:"Vous pouvez toujours synchroniser manuellement"})},[M,O,a]),qe=o.useCallback(t=>{if(!t)return"Jamais";const _=Math.floor((new Date().getTime()-t.getTime())/(1e3*60));return _<1?"√Ä l'instant":_<60?`Il y a ${_} min`:_<1440?`Il y a ${Math.floor(_/60)}h`:`Il y a ${Math.floor(_/1440)}j`},[]),ze=o.useCallback(()=>`‚öôÔ∏è G√©rez vos pr√©f√©rences MyFitHero, ${(s==null?void 0:s.first_name)||(s==null?void 0:s.username)||"Champion"}`,[s]);o.useEffect(()=>{de()},[de]),o.useEffect(()=>{if(M)return k(O)},[M,O,k]);const Oe=[{id:"profile",label:"Profil",icon:U},{id:"notifications",label:"Notifications",icon:es},{id:"wearables",label:"Appareils",icon:ge},{id:"privacy",label:"Confidentialit√©",icon:ss},{id:"preferences",label:"Pr√©f√©rences",icon:fe}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ue,{title:"Param√®tres",subtitle:ze(),showBackButton:!0,gradient:!0,rightContent:e.jsxs(C,{variant:"ghost",size:"sm",onClick:()=>r("/profile"),className:"text-white hover:bg-white/20",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Profil"]})}),e.jsx("div",{className:"p-4 space-y-6 max-w-4xl mx-auto",children:e.jsxs(Qe,{value:w,onValueChange:W,className:"space-y-6",children:[e.jsx(A,{children:e.jsx(q,{className:"p-2",children:e.jsx(Ke,{className:"grid w-full grid-cols-5",children:Oe.map(t=>{const E=t.icon;return e.jsxs(Xe,{value:t.id,className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:t.label})]},t.id)})})})}),e.jsx(G,{value:"profile",children:e.jsxs(A,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Informations du profil"}),e.jsx(Q,{children:"Modifiez vos informations personnelles"})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"full_name",children:"Nom complet"}),e.jsx(z,{id:"full_name",value:j.full_name,onChange:t=>I({...j,full_name:t.target.value}),placeholder:"Votre nom complet"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"username",children:"Nom d'utilisateur"}),e.jsx(z,{id:"username",value:j.username,onChange:t=>I({...j,username:t.target.value}),placeholder:"Nom d'utilisateur unique"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email"}),e.jsx(z,{id:"email",type:"email",value:j.email,onChange:t=>I({...j,email:t.target.value}),placeholder:"votre@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"phone",children:"T√©l√©phone"}),e.jsx(z,{id:"phone",type:"tel",value:j.phone,onChange:t=>I({...j,phone:t.target.value}),placeholder:"+33 6 12 34 56 78"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"bio",children:"Bio"}),e.jsx(Ze,{id:"bio",value:j.bio,onChange:t=>I({...j,bio:t.target.value}),placeholder:"Parlez-nous de vous, vos objectifs...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"city",children:"Ville"}),e.jsx(z,{id:"city",value:j.city,onChange:t=>I({...j,city:t.target.value}),placeholder:"Votre ville"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"country",children:"Pays"}),e.jsx(z,{id:"country",value:j.country,onChange:t=>I({...j,country:t.target.value}),placeholder:"Votre pays"})]})]}),e.jsxs(C,{onClick:Ee,disabled:p,className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),p?"Sauvegarde...":"Sauvegarder le profil"]})]})]})}),e.jsx(G,{value:"notifications",children:e.jsxs(A,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Pr√©f√©rences de notifications"}),e.jsx(Q,{children:"Choisissez les notifications que vous souhaitez recevoir"})]}),e.jsxs(q,{className:"space-y-4",children:[Object.entries(T).map(([t,E])=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{children:[e.jsxs(b,{htmlFor:t,className:"font-medium",children:[t==="workout_reminders"&&"Rappels d'entra√Ænement",t==="hydration_reminders"&&"Rappels d'hydratation",t==="meal_reminders"&&"Rappels de repas",t==="sleep_reminders"&&"Rappels de sommeil",t==="achievement_alerts"&&"Alertes de r√©ussite",t==="weekly_summary"&&"R√©sum√© hebdomadaire",t==="marketing_emails"&&"Emails marketing"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t==="workout_reminders"&&"Recevez des rappels pour vos entra√Ænements programm√©s",t==="hydration_reminders"&&"Restez hydrat√© avec des rappels r√©guliers",t==="meal_reminders"&&"Ne manquez jamais un repas",t==="sleep_reminders"&&"Notifications pour optimiser votre sommeil",t==="achievement_alerts"&&"C√©l√©brez vos r√©ussites et objectifs atteints",t==="weekly_summary"&&"Recevez votre r√©sum√© de progression hebdomadaire",t==="marketing_emails"&&"Nouvelles fonctionnalit√©s et offres sp√©ciales"]})]}),e.jsx(X,{id:t,checked:E,onCheckedChange:_=>le({...T,[t]:_})})]},t)),e.jsxs(C,{onClick:ke,disabled:p,className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),p?"Sauvegarde...":"Sauvegarder les notifications"]})]})]})}),e.jsx(G,{value:"wearables",children:e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(L,{children:e.jsxs(V,{className:"flex items-center",children:[e.jsx(ge,{className:"mr-2",size:20}),"Appareils connect√©s"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ts,{className:"text-gray-500",size:16}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Derni√®re synchronisation"}),e.jsx("p",{className:"text-xs text-gray-500",children:qe(u)})]})]}),e.jsx(Le,{variant:u?"default":"secondary",children:u?"Synchronis√©":"Jamais synchronis√©"})]}),m&&e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(he,{className:"text-red-500",size:16}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Erreur de synchronisation"}),e.jsx("p",{className:"text-xs text-red-600",children:m})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(C,{onClick:Me,disabled:!f||n,variant:f?"default":"outline",className:"flex items-center space-x-2",children:[e.jsx(as,{className:"text-red-500",size:16}),e.jsx("span",{children:"Apple Health"}),n&&e.jsx(ee,{className:"animate-spin",size:14})]}),e.jsxs(C,{onClick:Te,disabled:!g||n,variant:g?"default":"outline",className:"flex items-center space-x-2",children:[e.jsx(se,{className:"text-green-500",size:16}),e.jsx("span",{children:"Google Fit"}),n&&e.jsx(ee,{className:"animate-spin",size:14})]}),e.jsxs(C,{onClick:Re,disabled:!f&&!g||n,className:"flex items-center space-x-2 bg-purple-600 hover:bg-purple-700",children:[e.jsx(ee,{className:n?"animate-spin":"",size:16}),e.jsx("span",{children:"Tout synchroniser"})]})]}),e.jsx(te,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{className:"font-medium",children:"Synchronisation automatique"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Synchroniser automatiquement vos appareils"})]}),e.jsx(X,{checked:M,onCheckedChange:Ae})]}),M&&e.jsxs("div",{children:[e.jsx(b,{className:"text-sm",children:"Intervalle (minutes)"}),e.jsx("div",{className:"flex space-x-2 mt-2",children:[15,30,60,120].map(t=>e.jsxs(C,{variant:O===t?"default":"outline",size:"sm",onClick:()=>ie(t),children:[t,"min"]},t))})]})]}),H&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Derni√®res donn√©es synchronis√©es"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-blue-700",children:["Pas: ",((ue=H.steps)==null?void 0:ue.toLocaleString())||0]})}),e.jsx("div",{children:e.jsxs("p",{className:"text-blue-700",children:["Calories: ",H.caloriesBurned||0]})}),e.jsx("div",{children:e.jsxs("p",{className:"text-blue-700",children:["FC moy: ",H.avgHeartRate||0," bpm"]})}),e.jsx("div",{children:e.jsxs("p",{className:"text-blue-700",children:["Minutes actives: ",H.activeMinutes||0]})})]})]})]})]})})}),e.jsx(G,{value:"privacy",children:e.jsxs(A,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Confidentialit√© et s√©curit√©"}),e.jsx(Q,{children:"Contr√¥lez vos param√®tres de confidentialit√©"})]}),e.jsxs(q,{className:"space-y-4",children:[Object.entries(R).map(([t,E])=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[t==="profile_public"&&e.jsx(rs,{className:"text-gray-500",size:16}),t==="share_stats"&&e.jsx(se,{className:"text-gray-500",size:16}),t==="allow_friend_requests"&&e.jsx(U,{className:"text-gray-500",size:16}),t==="show_activity"&&e.jsx(is,{className:"text-gray-500",size:16}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:t,className:"font-medium",children:[t==="profile_public"&&"Profil public",t==="share_stats"&&"Partager les statistiques",t==="allow_friend_requests"&&"Demandes d'amis",t==="show_activity"&&"Afficher l'activit√©"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t==="profile_public"&&"Rendre votre profil visible aux autres utilisateurs",t==="share_stats"&&"Partager vos statistiques avec la communaut√©",t==="allow_friend_requests"&&"Permettre aux autres de vous envoyer des demandes d'amis",t==="show_activity"&&"Afficher votre statut d'activit√© aux amis"]})]})]}),e.jsx(X,{id:t,checked:E,onCheckedChange:_=>ce({...R,[t]:_})})]},t)),e.jsxs(C,{onClick:Pe,disabled:p,className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),p?"Sauvegarde...":"Sauvegarder la confidentialit√©"]}),e.jsx(te,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-red-600 flex items-center",children:[e.jsx(he,{className:"mr-2",size:16}),"Zone de danger"]}),e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["‚ö†Ô∏è ",e.jsx("strong",{children:"ATTENTION :"})," Cette action supprimera d√©finitivement votre compte MyFitHero et toutes vos donn√©es associ√©es (profil, entra√Ænements, statistiques, etc.). Cette action est ",e.jsx("strong",{children:"irr√©versible"}),"."]}),e.jsxs(C,{variant:"destructive",className:"w-full",onClick:De,disabled:ne,children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),ne?"Suppression en cours...":"Supprimer d√©finitivement mon compte"]})]})]})]})]})}),e.jsx(G,{value:"preferences",children:e.jsxs(A,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Pr√©f√©rences de l'application"}),e.jsx(Q,{children:"Personnalisez votre exp√©rience MyFitHero"})]}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(pe,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx(b,{className:"font-medium",children:"Langue"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choisissez votre langue pr√©f√©r√©e"})]})]}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:N.language,onChange:t=>F({...N,language:t.target.value}),children:[e.jsx("option",{value:"fr",children:"Fran√ßais"}),e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Espa√±ol"}),e.jsx("option",{value:"de",children:"Deutsch"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fe,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx(b,{className:"font-medium",children:"Th√®me"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Apparence de l'application"})]})]}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:N.theme,onChange:t=>F({...N,theme:t.target.value}),children:[e.jsx("option",{value:"light",children:"Clair"}),e.jsx("option",{value:"dark",children:"Sombre"}),e.jsx("option",{value:"system",children:"Syst√®me"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(se,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx(b,{className:"font-medium",children:"Unit√©s"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Syst√®me de mesure"})]})]}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:N.units,onChange:t=>F({...N,units:t.target.value}),children:[e.jsx("option",{value:"metric",children:"M√©trique (kg, cm)"}),e.jsx("option",{value:"imperial",children:"Imp√©rial (lbs, ft)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(pe,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx(b,{className:"font-medium",children:"Devise"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monnaie pour les abonnements"})]})]}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:N.currency,onChange:t=>F({...N,currency:t.target.value}),children:[e.jsx("option",{value:"EUR",children:"Euro (‚Ç¨)"}),e.jsx("option",{value:"USD",children:"Dollar ($)"}),e.jsx("option",{value:"GBP",children:"Livre (¬£)"}),e.jsx("option",{value:"CAD",children:"Dollar canadien"})]})]})]})]}),e.jsxs(C,{onClick:Ie,disabled:p,className:"w-full bg-purple-600 hover:bg-purple-700",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),p?"Sauvegarde...":"Sauvegarder les pr√©f√©rences"]})]})]})})]})})]})},qs=Object.freeze(Object.defineProperty({__proto__:null,default:fs},Symbol.toStringTag,{value:"Module"}));export{xe as A,ge as S,fs as a,qs as b,cs as u};
//# sourceMappingURL=SettingsPage-2dzb-c-E.js.map
