{"version":3,"file":"AdminPage-BNdGCIjD.js","sources":["../../src/features/admin/components/AdminDashboard.tsx","../../src/features/auth/hooks/useAuthStatus.ts","../../src/features/admin/pages/AdminPage.tsx"],"sourcesContent":["// client/src/features/admin/components/AdminDashboard.tsx\nimport React from 'react';\nimport { Card } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\n\ninterface AdminDashboardProps {\n  userProfile?: {\n    id: string;\n    role: string;\n    email?: string;\n  };\n}\n\nexport const AdminDashboard: React.FC<AdminDashboardProps> = ({ userProfile }) => {\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">Tableau de bord Admin</h1>\n          <p className=\"text-gray-600 mt-2\">Gestion et administration de MyFitHero</p>\n        </div>\n\n        {userProfile && (\n          <Card className=\"mb-6 p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h2 className=\"text-xl font-semibold\">Profil Administrateur</h2>\n                <p className=\"text-gray-600\">{userProfile.email || userProfile.id}</p>\n              </div>\n              <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-800\">\n                {userProfile.role}\n              </Badge>\n            </div>\n          </Card>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8\">\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Utilisateurs</h3>\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between\">\n                <span>Total utilisateurs</span>\n                <Badge variant=\"outline\">--</Badge>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Nouveaux (7j)</span>\n                <Badge variant=\"outline\">--</Badge>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" className=\"w-full\">\n                G√©rer les utilisateurs\n              </Button>\n            </div>\n          </Card>\n\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Workouts</h3>\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between\">\n                <span>Total workouts</span>\n                <Badge variant=\"outline\">--</Badge>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Aujourd&apos;hui</span>\n                <Badge variant=\"outline\">--</Badge>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" className=\"w-full\">\n                Voir les statistiques\n              </Button>\n            </div>\n          </Card>\n\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Syst√®me</h3>\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between\">\n                <span>Status</span>\n                <Badge className=\"bg-green-100 text-green-800\">Actif</Badge>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Version</span>\n                <Badge variant=\"outline\">v4.0</Badge>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" className=\"w-full\">\n                Param√®tres syst√®me\n              </Button>\n            </div>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Actions rapides</h3>\n            <div className=\"space-y-3\">\n              <Button variant=\"outline\" className=\"w-full justify-start\">\n                üìä Voir les analytics\n              </Button>\n              <Button variant=\"outline\" className=\"w-full justify-start\">\n                üë• G√©rer les utilisateurs\n              </Button>\n              <Button variant=\"outline\" className=\"w-full justify-start\">\n                üí≥ Gestion des paiements\n              </Button>\n              <Button variant=\"outline\" className=\"w-full justify-start\">\n                üì± Notifications\n              </Button>\n              <Button variant=\"outline\" className=\"w-full justify-start\">\n                üéØ Support utilisateurs\n              </Button>\n            </div>\n          </Card>\n\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Activit√© r√©cente</h3>\n            <div className=\"space-y-4\">\n              <div className=\"border-l-4 border-blue-500 pl-4\">\n                <p className=\"text-sm font-medium\">Nouveau utilisateur inscrit</p>\n                <p className=\"text-xs text-gray-500\">Il y a 2 heures</p>\n              </div>\n              <div className=\"border-l-4 border-green-500 pl-4\">\n                <p className=\"text-sm font-medium\">Workout compl√©t√©</p>\n                <p className=\"text-xs text-gray-500\">Il y a 3 heures</p>\n              </div>\n              <div className=\"border-l-4 border-yellow-500 pl-4\">\n                <p className=\"text-sm font-medium\">Erreur syst√®me r√©solue</p>\n                <p className=\"text-xs text-gray-500\">Il y a 5 heures</p>\n              </div>\n            </div>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminDashboard;\n","import { useState, useEffect } from 'react';\nimport { supabase } from '@/lib/supabase';\n\nexport interface AuthStatus {\n  isAuthenticated: boolean;\n  user: any | null;\n  session: any | null;\n  loading: boolean;\n  signOut: () => Promise<void>;\n}\n\nexport const useAuthStatus = (): AuthStatus => {\n  const [user, setUser] = useState<any | null>(null);\n  const [session, setSession] = useState<any | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // V√©rifier la session actuelle\n    const checkUser = async () => {\n      try {\n        const {\n          data: { session },\n          error,\n        } = await supabase.auth.getSession();\n        if (error) throw error;\n\n        setSession(session);\n        setUser(session?.user || null);\n      } catch {\n        console.error('Error checking user:', error);\n        setUser(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    checkUser();\n\n    // √âcouter les changements d'authentification\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\n      setUser(session?.user ?? null);\n      setLoading(false);\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      setUser(null);\n    } catch {\n      console.error('Error signing out:', error);\n    }\n  };\n\n  return {\n    isAuthenticated: !!user,\n    user,\n    session,\n    loading,\n    signOut,\n  };\n};\n","// client/src/pages/Admin.tsx\nimport React, { useEffect, useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { AdminDashboard } from '../components';\nimport { useAuthStatus } from '@/features/auth/hooks/useAuthStatus';\nimport { supabase } from '@/lib/supabase';\nimport { useToast } from '@/shared/hooks/use-toast';\n\ninterface UserProfile {\n  id: string;\n  role: string;\n  email?: string;\n}\n\nconst Admin: React.FC = () => {\n  const [location, setLocation] = useLocation();\n  const { session, loading, isAuthenticated } = useAuthStatus();\n  const { toast } = useToast();\n\n  const [userProfile, setUserProfile] = useState<UserProfile | null>(null);\n  const [profileLoading, setProfileLoading] = useState(true);\n\n  // R√©cup√©rer le profil utilisateur avec le r√¥le\n  const fetchUserProfile = async (userId: string) => {\n    try {\n      const { data, error } = await supabase\n        .from('user_profiles')\n        .select('id, role')\n        .eq('id', userId)\n        .single();\n\n      if (error) {\n        console.error('Erreur r√©cup√©ration profil:', error);\n        return null;\n      }\n\n      return data;\n    } catch {\n      console.error('Erreur fetchUserProfile:', error);\n      return null;\n    }\n  };\n\n  useEffect(() => {\n    const checkAdminAccess = async () => {\n      // Si pas encore charg√©, on attend\n      if (loading) return;\n\n      // Si pas authentifi√©, redirection vers login\n      if (!isAuthenticated || !session?.user) {\n        setLocation('/login');\n        return;\n      }\n\n      // R√©cup√©rer le profil avec le r√¥le\n      setProfileLoading(true);\n      const profile = await fetchUserProfile(session.user.id);\n\n      if (!profile) {\n        toast({\n          title: \"Erreur d'acc√®s\",\n          description: 'Impossible de v√©rifier vos permissions',\n          variant: 'destructive',\n        });\n        setLocation('/');\n        return;\n      }\n\n      setUserProfile(profile);\n\n      // V√©rifier si l'utilisateur est admin\n      if (profile.role !== 'admin') {\n        toast({\n          title: 'Acc√®s refus√©',\n          description: \"Vous n'avez pas les permissions pour acc√©der √† cette page\",\n          variant: 'destructive',\n        });\n        setLocation('/');\n        return;\n      }\n\n      setProfileLoading(false);\n    };\n\n    checkAdminAccess();\n  }, [session, loading, isAuthenticated, setLocation, toast]);\n\n  // Affichage du loader pendant la v√©rification\n  if (loading || profileLoading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-50\">\n        <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mb-4\"></div>\n        <p className=\"text-gray-600 text-sm\">\n          {loading ? \"V√©rification de l'authentification...\" : 'V√©rification des permissions...'}\n        </p>\n        <span className=\"sr-only\">Chargement de la page d\\'administration</span>\n      </div>\n    );\n  }\n\n  // Si pas authentifi√© ou pas admin, ne rien afficher\n  // (la redirection est d√©j√† en cours)\n  if (!isAuthenticated || !userProfile || userProfile.role !== 'admin') {\n    return null;\n  }\n\n  // Afficher le dashboard admin\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header optionnel pour indiquer le mode admin */}\n      <div className=\"bg-red-600 text-white px-4 py-2 text-center text-sm font-medium\">\n        üîí Mode Administrateur - Acc√®s restreint\n      </div>\n\n      <AdminDashboard />\n    </div>\n  );\n};\n\nexport default Admin;\n"],"names":["AdminDashboard","userProfile","jsxs","jsx","Card","Badge","Button","useAuthStatus","user","setUser","useState","session","setSession","loading","setLoading","useEffect","error","supabase","subscription","event","Admin","location","setLocation","useLocation","isAuthenticated","toast","useToast","setUserProfile","profileLoading","setProfileLoading","fetchUserProfile","userId","data","profile"],"mappings":"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"}