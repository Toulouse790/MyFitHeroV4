import{d as O,u as J,e as Z,r as d,f as A,j as e}from"./index-CjnEZlsY.js";import{u as G}from"./use-toast-1UJezmcI.js";import{U as $}from"./UniformHeader-CjBBS_mR.js";import{C as l,d as K,c as i,a as u,b as g,f as b,B as x}from"./badge-0XDKnG36.js";import{P as D}from"./progress-B_6640an.js";import{T as Q,a as W,b as X,c as v}from"./tabs-jX3VcdfO.js";import{S as Y,a as U,b as ee,c as se,d as y,e as P}from"./select-_IJcDPV4.js";import{A as M}from"./AIIntelligence-4kibXt-7.js";import{C as ae}from"./chart-column-CLHNa-_6.js";import{T as w}from"./trending-up-Cmv-0pKX.js";import{U as _}from"./users-B-1ArgqR.js";import{A as te}from"./activity-C-flMYAi.js";import{T as re}from"./target-Di6UzvH3.js";import{Z as R}from"./zap-BxpV5bJv.js";import{A as le}from"./award-BcNAyl6q.js";import{C as ne}from"./calendar-D7qE-8IO.js";import{E as L}from"./eye-CSV1oSLp.js";import{T as ie}from"./trophy-CS6fcHcf.js";import"./index-GGMoTRFm.js";import"./user-BtYr8gLe.js";import"./clsx-B-dksMZM.js";import"./index-DdwsCUG1.js";import"./index-QD0cdno-.js";import"./index-Dxu7zm8J.js";import"./chevron-up-FALq0kkK.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],f=O("download",ce);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],C=O("file-text",oe),Le=()=>{J();const{appStoreUser:s}=Z(),{toast:o}=G(),[S,I]=d.useState("tableau-bord"),[c,V]=d.useState("month"),[a,B]=d.useState(null),[q,k]=d.useState(!0),[m,T]=d.useState(!1),E=d.useCallback(async()=>{if(s!=null&&s.id){k(!0);try{const{data:t}=await A.from("workout_sessions").select("*").eq("user_id",s.id).gte("created_at",new Date(Date.now()-2592e6).toISOString()),{data:r}=await A.from("daily_stats").select("*").eq("user_id",s.id).gte("stat_date",new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]),h={consistency_rate:r!=null&&r.length?Math.round(r.length/30*100):85,streak_days:12,monthly_improvement:23,goals_achieved:92,ranking_percentile:15,total_workouts:(t==null?void 0:t.length)||24,total_calories:(t==null?void 0:t.reduce((p,n)=>p+(n.calories_burned||0),0))||3840,average_sleep:7.5,hydration_rate:88};B(h)}catch{console.error("Erreur chargement analytics:",error),o({title:"Erreur de chargement",description:"Impossible de charger les donn√©es analytics",variant:"destructive"})}finally{k(!1)}}},[s==null?void 0:s.id,o]),F=d.useMemo(()=>{const t=(s==null?void 0:s.first_name)||(s==null?void 0:s.username)||"Champion",r=(s==null?void 0:s.sport)||"sport";return a?a.consistency_rate>=90?`üéØ Excellent ${t} ! Vos performances en ${r} sont remarquables`:a.consistency_rate>=70?`üí™ Tr√®s bien ${t}, votre progression en ${r} est solide`:`üöÄ ${t}, am√©liorons ensemble vos r√©sultats en ${r}`:`üìä Analysons vos performances, ${t}`},[s,a]),N=d.useCallback(async t=>{if(!(!a||!(s!=null&&s.id))){T(!0);try{const r={user_id:s.id,sport:s.sport,export_date:new Date().toISOString(),period:c,analytics:a,format:t};if(await new Promise(h=>setTimeout(h,2e3)),t==="json"){const h=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),p=URL.createObjectURL(h),n=document.createElement("a");n.href=p,n.download=`analytics-${s.sport}-${c}.json`,n.setAttribute("aria-label","T√©l√©charger les donn√©es analytics au format JSON"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(p)}else if(t==="csv"){const h=["M√©trique,Valeur",`Taux de consistance,${a.consistency_rate}%`,`S√©rie de jours,${a.streak_days}`,`Am√©lioration mensuelle,${a.monthly_improvement}%`,`Objectifs atteints,${a.goals_achieved}%`,`Total entra√Ænements,${a.total_workouts}`,`Total calories,${a.total_calories}`,`Sommeil moyen,${a.average_sleep}h`,`Taux hydratation,${a.hydration_rate}%`].join(`
`),p=new Blob([h],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(p),j=document.createElement("a");j.href=n,j.download=`analytics-${s.sport}-${c}.csv`,j.setAttribute("aria-label","T√©l√©charger les donn√©es analytics au format CSV"),document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(n)}o({title:"Export r√©ussi",description:`Donn√©es ${t.toUpperCase()} t√©l√©charg√©es avec succ√®s`}),typeof window<"u"&&window.gtag&&window.gtag("event","analytics_export",{format:t,period:c,sport:s.sport,user_id:s.id})}catch{console.error("Erreur export:",error),o({title:"Erreur d'export",description:"Impossible d'exporter les donn√©es",variant:"destructive"})}finally{T(!1)}}},[a,s,c,o]);if(d.useEffect(()=>{E()},[E,c]),q||!a)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx($,{title:"Analytics",subtitle:"Chargement des donn√©es...",showBackButton:!0,gradient:!0}),e.jsx("div",{className:"p-4 space-y-6 max-w-6xl mx-auto",children:Array.from({length:4}).map((t,r)=>e.jsx(l,{className:"h-32 animate-pulse bg-gray-200"},r))})]});const H=[{id:"tableau-bord",label:"Tableau de bord",icon:ae},{id:"rapports",label:"Rapports",icon:w},{id:"export",label:"Export",icon:f},{id:"social",label:"Social",icon:_}],z=t=>{switch(t){case"week":return"Semaine";case"month":return"Mois";case"quarter":return"Trimestre";default:return"Mois"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx($,{title:"Analytics",subtitle:F,showBackButton:!0,gradient:!0,rightContent:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(K,{variant:"secondary",className:"bg-white/20 text-white",children:[a.consistency_rate,"% consistance"]}),e.jsxs(Y,{value:c,onValueChange:t=>V(t),children:[e.jsx(U,{className:"w-32 bg-white/20 border-white/30 text-white","aria-label":"S√©lectionner la p√©riode",children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(y,{value:"week",children:"Semaine"}),e.jsx(y,{value:"month",children:"Mois"}),e.jsx(y,{value:"quarter",children:"Trimestre"})]})]})]})}),e.jsx("div",{className:"p-4 space-y-6 max-w-6xl mx-auto",children:e.jsx(l,{children:e.jsx(i,{className:"p-2",children:e.jsxs(Q,{value:S,onValueChange:t=>I(t),className:"space-y-6",children:[e.jsx(W,{className:"grid w-full grid-cols-4",children:H.map(t=>{const r=t.icon;return e.jsxs(X,{value:t.id,className:"flex items-center space-x-2",children:[e.jsx(r,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:t.label})]},t.id)})}),e.jsxs(v,{value:"tableau-bord",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(l,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(te,{className:"h-8 w-8 mx-auto text-blue-600 mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:a.total_workouts}),e.jsx("div",{className:"text-xs text-blue-600",children:"Entra√Ænements"})]})}),e.jsx(l,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(re,{className:"h-8 w-8 mx-auto text-green-600 mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[a.consistency_rate,"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Consistance"})]})}),e.jsx(l,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(R,{className:"h-8 w-8 mx-auto text-orange-600 mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:a.total_calories.toLocaleString()}),e.jsx("div",{className:"text-xs text-orange-600",children:"Calories"})]})}),e.jsx(l,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(le,{className:"h-8 w-8 mx-auto text-purple-600 mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:a.streak_days}),e.jsx("div",{className:"text-xs text-purple-600",children:"Jours de suite"})]})})]}),e.jsxs(l,{children:[e.jsx(u,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsxs("span",{children:["Progression ",z(c)]})]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Objectifs atteints"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.goals_achieved,"%"]})]}),e.jsx(D,{value:a.goals_achieved,className:"h-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Hydratation"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.hydration_rate,"%"]})]}),e.jsx(D,{value:a.hydration_rate,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["+",a.monthly_improvement,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Am√©lioration"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["Top ",a.ranking_percentile,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Classement"})]})]})]})]}),e.jsx(M,{pillar:"analytics",showPredictions:!0,showCoaching:!0,showRecommendations:!0})]}),e.jsx(v,{value:"rapports",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(l,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ne,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:"Consistance"}),e.jsx(b,{children:"Analyse de vos habitudes"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Taux de r√©ussite"}),e.jsxs("span",{className:"font-bold text-green-600",children:[a.consistency_rate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"S√©rie actuelle"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[a.streak_days," jours"]})]}),e.jsxs(x,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>o({title:"Fonctionnalit√© en d√©veloppement",description:"Rapport d√©taill√© bient√¥t disponible"}),children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Rapport d√©taill√©"]})]})})]}),e.jsxs(l,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:"Progression"}),e.jsx(b,{children:"√âvolution performances"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Am√©lioration"}),e.jsxs("span",{className:"font-bold text-orange-600",children:["+",a.monthly_improvement,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Piliers actifs"}),e.jsx("span",{className:"font-bold text-purple-600",children:"4/4"})]}),e.jsxs(x,{className:"w-full bg-orange-600 hover:bg-orange-700",onClick:()=>N("pdf"),disabled:m,children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),m?"G√©n√©ration...":"T√©l√©charger PDF"]})]})})]}),e.jsxs(l,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:"Comparatif"}),e.jsx(b,{children:"Vs vos objectifs"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Objectifs atteints"}),e.jsxs("span",{className:"font-bold text-red-600",children:[a.goals_achieved,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Classement"}),e.jsxs("span",{className:"font-bold text-blue-600",children:["Top ",a.ranking_percentile,"%"]})]}),e.jsxs(x,{className:"w-full bg-red-600 hover:bg-red-700",onClick:()=>o({title:"Fonctionnalit√© en d√©veloppement",description:"Comparaison d√©taill√©e bient√¥t disponible"}),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Voir comparaison"]})]})})]})]})}),e.jsx(v,{value:"export",className:"space-y-6",children:e.jsxs(l,{className:"max-w-2xl mx-auto",children:[e.jsxs(u,{className:"text-center",children:[e.jsxs(g,{className:"flex items-center justify-center space-x-2",children:[e.jsx(f,{className:"h-5 w-5"}),e.jsx("span",{children:"Exportation des Donn√©es"})]}),e.jsx(b,{children:"T√©l√©chargez vos analytics dans diff√©rents formats"})]}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(x,{onClick:()=>N("json"),disabled:m,className:"h-20 flex flex-col space-y-2 bg-blue-600 hover:bg-blue-700","aria-label":"Exporter les donn√©es au format JSON",children:[e.jsx(f,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:m?"Export...":"JSON Complet"})]}),e.jsxs(x,{onClick:()=>N("csv"),disabled:m,variant:"outline",className:"h-20 flex flex-col space-y-2 border-green-200 hover:bg-green-50","aria-label":"Exporter les donn√©es au format CSV",children:[e.jsx(C,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:m?"Export...":"CSV Tableau"})]}),e.jsxs(x,{onClick:()=>N("pdf"),disabled:m,variant:"outline",className:"h-20 flex flex-col space-y-2 border-orange-200 hover:bg-orange-50","aria-label":"Exporter les donn√©es au format PDF",children:[e.jsx(C,{className:"h-5 w-5 text-orange-600"}),e.jsx("span",{className:"text-sm text-orange-600",children:m?"Export...":"Rapport PDF"})]})]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Donn√©es incluses"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["M√©triques des"," ",c==="week"?"7":c==="month"?"30":"90"," ","derniers jours : entra√Ænements, nutrition, hydratation, sommeil, progression ",s==null?void 0:s.sport]})]})]})})]})]})}),e.jsxs(v,{value:"social",className:"space-y-6",children:[e.jsxs(l,{children:[e.jsxs(u,{className:"text-center",children:[e.jsxs(g,{className:"flex items-center justify-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{children:"Comparaison Sociale"})]}),e.jsxs(b,{children:["Comparez vos performances avec la communaut√© ",s==null?void 0:s.sport]})]}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg",children:[e.jsx(ie,{className:"h-12 w-12 mx-auto text-purple-600 mb-4"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:["Top ",a.ranking_percentile,"%"]}),e.jsxs("div",{className:"text-sm text-purple-600",children:["Classement global ",s==null?void 0:s.sport]})]}),e.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg",children:[e.jsx(P,{className:"h-12 w-12 mx-auto text-green-600 mb-4"}),e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[a.consistency_rate,"%"]}),e.jsx("div",{className:"text-sm text-green-600",children:"Au-dessus de la moyenne"})]})]}),e.jsx("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200",children:e.jsx("p",{className:"text-sm text-amber-800 text-center",children:"üöß Fonctionnalit√© en d√©veloppement - Comparaison avec vos amis bient√¥t disponible"})}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(x,{variant:"outline",className:"border-blue-200 hover:bg-blue-50",onClick:()=>o({title:"Bient√¥t disponible",description:"Invitation d'amis en d√©veloppement"}),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Inviter des amis"]}),e.jsxs(x,{variant:"outline",className:"border-green-200 hover:bg-green-50",onClick:()=>o({title:"Bient√¥t disponible",description:"Partage de stats en d√©veloppement"}),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Partager mes stats"]})]})]})]}),e.jsx(M,{pillar:"social",showPredictions:!1,showCoaching:!0,showRecommendations:!0})]})]})})})})]})};export{Le as default};
//# sourceMappingURL=AnalyticsPage-UMEII_WR.js.map
