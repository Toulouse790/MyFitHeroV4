import{r as S,c as q,j as t,p as J,R as T}from"./index-CjnEZlsY.js";import{c as W}from"./index-DYXWGdlE.js";import{u as V}from"./useQuery-Be-wEKB7.js";import{c as B}from"./clsx-B-dksMZM.js";import{b as D,c as H,d as X}from"./index-BWjCeQlA.js";import{m as Z}from"./proxy-BMX__oQJ.js";import"./QueryClientProvider-ZBf36FVV.js";import"./iconBase-BriXq5B3.js";var U=typeof global=="object"&&global&&global.Object===Object&&global,Y=typeof self=="object"&&self&&self.Object===Object&&self,G=U||Y||Function("return this")(),I=G.Symbol,$=Object.prototype,Q=$.hasOwnProperty,K=$.toString,k=I?I.toStringTag:void 0;function ee(e){var a=Q.call(e,k),r=e[k];try{e[k]=void 0;var n=!0}catch{}var s=K.call(e);return n&&(a?e[k]=r:delete e[k]),s}var te=Object.prototype,re=te.toString;function ae(e){return re.call(e)}var se="[object Null]",ne="[object Undefined]",z=I?I.toStringTag:void 0;function ie(e){return e==null?e===void 0?ne:se:z&&z in Object(e)?ee(e):ae(e)}function oe(e){return e!=null&&typeof e=="object"}var ce="[object Symbol]";function le(e){return typeof e=="symbol"||oe(e)&&ie(e)==ce}var de=/\s/;function ue(e){for(var a=e.length;a--&&de.test(e.charAt(a)););return a}var fe=/^\s+/;function me(e){return e&&e.slice(0,ue(e)+1).replace(fe,"")}function P(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var M=NaN,xe=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,he=/^0o[0-7]+$/i,be=parseInt;function _(e){if(typeof e=="number")return e;if(le(e))return M;if(P(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=P(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=me(e);var r=ge.test(e);return r||he.test(e)?be(e.slice(2),r?2:8):xe.test(e)?M:+e}var F=function(){return G.Date.now()},pe="Expected a function",ye=Math.max,je=Math.min;function ve(e,a,r){var n,s,o,i,c,u,x=0,y=!1,l=!1,h=!0;if(typeof e!="function")throw new TypeError(pe);a=_(a)||0,P(r)&&(y=!!r.leading,l="maxWait"in r,o=l?ye(_(r.maxWait)||0,a):o,h="trailing"in r?!!r.trailing:h);function m(d){var g=n,N=s;return n=s=void 0,x=d,i=e.apply(N,g),i}function j(d){return x=d,c=setTimeout(p,a),y?m(d):i}function b(d){var g=d-u,N=d-x,A=a-g;return l?je(A,o-N):A}function v(d){var g=d-u,N=d-x;return u===void 0||g>=a||g<0||l&&N>=o}function p(){var d=F();if(v(d))return f(d);c=setTimeout(p,b(d))}function f(d){return c=void 0,h&&n?m(d):(n=s=void 0,i)}function w(){c!==void 0&&clearTimeout(c),x=0,n=u=s=c=void 0}function E(){return c===void 0?i:f(F())}function C(){var d=F(),g=v(d);if(n=arguments,s=this,u=d,g){if(c===void 0)return j(u);if(l)return clearTimeout(c),c=setTimeout(p,a),m(u)}return c===void 0&&(c=setTimeout(p,a)),i}return C.cancel=w,C.flush=E,C}const we="https://zfmlzxhxhaezdkzjanbc.supabase.co",Ne="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmbWx6eGh4aGFlemRremphbmJjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NDc4MzIsImV4cCI6MjA2NjMyMzgzMn0.x6GpX8ep6YxVEZQt7pcH0SIWzxhTYcXLnaVmD5IGErw",L=W(we,Ne),ke=q()(J((e,a)=>({favorites:new Set,addFavorite:r=>e(n=>({favorites:new Set(n.favorites).add(r)})),removeFavorite:r=>e(n=>{const s=new Set(n.favorites);return s.delete(r),{favorites:s}}),toggleFavorite:r=>{const{favorites:n,addFavorite:s,removeFavorite:o}=a();n.has(r)?o(r):s(r)}}),{name:"myfithero-exercise-favorites"}));async function Se({page:e,pageSize:a,searchTerm:r,filterCategory:n,filterDifficulty:s,filterEquipment:o,filterMovementType:i,filterMuscleGroups:c,filterSport:u,filterPosition:x,filterSeasonPhase:y}){let l=L.from("exercises_library").select("*",{count:"exact"}).order("name");if(r&&r.trim()!==""){const b=r.trim().toLowerCase();l=l.ilike("name",`%${b}%`)}n&&n.length>0&&(l=l.in("category",n)),s&&s.length>0&&(l=l.in("difficulty",s)),o&&o.length>0&&(l=l.in("equipment",o)),i&&i.length>0&&(l=l.in("movement_type",i)),c&&c.length>0&&c.forEach(b=>{l=l.contains("muscle_groups",[b])}),l=l.range(e*a,e*a+a-1);const{data:h,error:m,count:j}=await l;if(m)throw m;return{exercises:h??[],count:j}}function Te(e){var r,n,s,o,i;const a=["exercises",e.page,e.pageSize,e.searchTerm,(r=e.filterCategory)==null?void 0:r.join(","),(n=e.filterDifficulty)==null?void 0:n.join(","),(s=e.filterEquipment)==null?void 0:s.join(","),(o=e.filterMovementType)==null?void 0:o.join(","),(i=e.filterMuscleGroups)==null?void 0:i.join(","),e.filterSport,e.filterPosition,e.filterSeasonPhase];return V(a,()=>Se(e))}const Ie=({searchTerm:e,onSearchChange:a})=>{const[r,n]=T.useState(e),s=T.useMemo(()=>ve(a,400),[a]),o=i=>{n(i.target.value),s(i.target.value)};return T.useEffect(()=>{n(e)},[e]),t.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[t.jsx("input",{type:"search",value:r,onChange:o,placeholder:"Rechercher un exercice...",className:"w-full border border-gray-300 rounded-md py-2 pl-10 pr-3 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white","aria-label":"Rechercher un exercice"}),t.jsx(D,{className:"absolute left-3 top-2.5 text-gray-400 dark:text-gray-500",size:22})]})},Ee=["chest","back","shoulders","arms","legs","core","cardio","flexibility"],Ce=["beginner","intermediate","advanced"],Fe=["bodyweight","dumbbells","barbell","resistance_band","machine","other"],Oe=["push","pull","legs","core","full_body"],Pe=["pectorals","triceps","deltoids","biceps","quadriceps","glutes","hamstrings","core","calves","back","abdominals","obliques","forearms","shoulders","chest","legs"],Ae=({filters:e,onChange:a})=>{const r=(s,o)=>o.map(i=>{const c=e[s].includes(i);return t.jsxs("label",{className:"inline-flex items-center space-x-2 cursor-pointer","aria-checked":c,role:"checkbox",tabIndex:0,onKeyDown:u=>{u.key==="Enter"&&n(i,s)},children:[t.jsx("input",{type:"checkbox",className:"hidden",checked:c,onChange:()=>n(i,s),"aria-label":i}),t.jsx("div",{className:B("w-5 h-5 border rounded-md flex items-center justify-center",c?"bg-blue-600 border-blue-600":"border-gray-300","dark:border-gray-600 dark:bg-gray-800"),children:c&&t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{d:"M16.707 5.293a1 1 0 00-1.414 0L8 12.586 5.707 10.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l8-8a1 1 0 000-1.414z"})})}),t.jsx("span",{className:"text-sm dark:text-gray-300",children:i})]},i)}),n=S.useCallback((s,o)=>{const i=e[o];i.includes(s)?a(o,i.filter(c=>c!==s)):a(o,[...i,s])},[e,a]);return t.jsxs("section",{className:"p-4 border rounded-md max-w-4xl mx-auto bg-white dark:bg-gray-900 shadow mb-4",children:[t.jsx("h3",{className:"font-semibold mb-2 text-lg dark:text-gray-100",children:"Filtres"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-gray-700 dark:text-gray-300",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Catégorie"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r("category",Ee)})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Difficulté"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r("difficulty",Ce)})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Equipement"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r("equipment",Fe)})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Type de mouvement"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r("movementType",Oe)})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("strong",{children:"Groupes musculaires"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r("muscleGroups",Pe)})]})]})]})},R=({exercise:e,isFavorite:a,onToggleFavorite:r})=>t.jsxs(Z.article,{layout:!0,whileHover:{scale:1.03},className:"bg-white dark:bg-gray-800 rounded-lg shadow p-3 flex flex-col","aria-label":`Exercice ${e.name}, catégorie ${e.category}, difficulté ${e.difficulty}`,children:[t.jsx("div",{className:"relative w-full pt-[56.25%] rounded overflow-hidden mb-2",children:e.video_url?t.jsx("video",{src:e.video_url,controls:!0,className:"absolute top-0 left-0 w-full h-full object-cover rounded","aria-label":`${e.name} - vidéo démonstration`}):e.image_url?t.jsx("img",{src:e.image_url,alt:`Image exercice ${e.name}`,className:"absolute top-0 left-0 w-full h-full object-cover rounded"}):t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center rounded",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-300",children:"Aucune image"})})}),t.jsx("h4",{className:"text-lg font-semibold mb-1 text-gray-900 dark:text-white",children:e.name}),t.jsx("p",{className:"flex-grow text-sm text-gray-700 dark:text-gray-300 mb-2 line-clamp-3",children:e.description}),t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 flex-wrap gap-2",children:[t.jsxs("span",{children:["Équipement: ",e.equipment]}),t.jsxs("span",{children:["Difficulté: ",e.difficulty]}),t.jsx("button",{"aria-label":a?"Retirer des favoris":"Ajouter aux favoris",onClick:()=>r(e.id),className:"p-1 text-red-500 hover:text-red-600 focus:outline-none",children:a?t.jsx(H,{size:22}):t.jsx(X,{size:22})})]})]}),ze=({favoriteIds:e})=>{const[a,r]=T.useState([]);return S.useEffect(()=>{async function n(){if(e.size===0){r([]);return}const s=Array.from(e),{data:o,error:i}=await L.from("exercises_library").select("*").in("id",s);!i&&o&&r(o)}n()},[e]),a.length===0?t.jsx("p",{className:"text-center p-4",children:"Aucun favori ajouté."}):t.jsx("section",{"aria-label":"Liste des exercices favoris",className:"max-w-4xl mx-auto p-2 grid grid-cols-1 md:grid-cols-3 gap-4",children:a.map(n=>t.jsx(R,{exercise:n,isFavorite:!0,onToggleFavorite:()=>{}},n.id))})},O=20,We=()=>{const[e,a]=S.useState(""),[r,n]=S.useState({category:[],difficulty:[],equipment:[],movementType:[],muscleGroups:[]}),[s,o]=S.useState(0),{favorites:i,toggleFavorite:c}=ke(),{data:u,isLoading:x,isError:y}=Te({page:s,pageSize:O,searchTerm:e,filterCategory:r.category,filterDifficulty:r.difficulty,filterEquipment:r.equipment,filterMovementType:r.movementType,filterMuscleGroups:r.muscleGroups}),l=(u==null?void 0:u.exercises)??[],h=(u==null?void 0:u.count)??0,m=Math.ceil(h/O),j=(f,w)=>{n(E=>({...E,[f]:w})),o(0)},b=f=>{a(f),o(0)},v=s+1<m,p=s>0;return t.jsxs("main",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 py-6 px-4",children:[t.jsx("h1",{className:"text-3xl font-extrabold text-center mb-6",children:"Exercices MyFitHero"}),t.jsx(Ie,{searchTerm:e,onSearchChange:b}),t.jsx(Ae,{filters:r,onChange:j}),t.jsx("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6",children:x?Array.from({length:O}).map((f,w)=>t.jsx("div",{className:"h-72 rounded-lg bg-gray-300 dark:bg-gray-700 animate-pulse"},w)):y?t.jsx("div",{className:"col-span-full text-center text-red-600",children:"Erreur chargement exercices."}):l.length===0?t.jsx("div",{className:"col-span-full text-center text-gray-600 dark:text-gray-400",children:"Aucun exercice trouvé."}):l.map(f=>t.jsx(R,{exercise:f,isFavorite:i.has(f.id),onToggleFavorite:c},f.id))}),t.jsxs("nav",{className:"flex justify-center items-center mt-8 space-x-4",children:[t.jsx("button",{onClick:()=>p&&o(f=>f-1),disabled:!p,className:"px-4 py-2 rounded bg-blue-600 text-white disabled:opacity-50","aria-label":"Page précédente",children:"Précédent"}),t.jsxs("span",{"aria-live":"polite","aria-atomic":"true",className:"text-lg",children:["Page ",s+1," / ",m]}),t.jsx("button",{onClick:()=>v&&o(f=>f+1),disabled:!v,className:"px-4 py-2 rounded bg-blue-600 text-white disabled:opacity-50","aria-label":"Page suivante",children:"Suivant"})]}),t.jsxs("section",{"aria-label":"Vos exercices favoris",className:"mt-12 max-w-6xl mx-auto",children:[t.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Vos favoris"}),t.jsx(ze,{favoriteIds:i})]})]})};export{We as default};
//# sourceMappingURL=ExercisesPage-HACvLvUl.js.map
