var Rt=e=>{throw TypeError(e)};var it=(e,t,s)=>t.has(e)||Rt("Cannot "+s);var i=(e,t,s)=>(it(e,t,"read from private field"),s?s.call(e):t.get(e)),p=(e,t,s)=>t.has(e)?Rt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e,t,s,r)=>(it(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),b=(e,t,s)=>(it(e,t,"access private method"),s);import{r as F}from"./index-CjnEZlsY.js";import{u as Dt}from"./QueryClientProvider-ZBf36FVV.js";var bt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},G=typeof window>"u"||"Deno"in globalThis;function rt(){}function Ot(e){return typeof e=="number"&&e>=0&&e!==1/0}function _t(e,t){return Math.max(e+(t||0)-Date.now(),0)}function J(e,t){return typeof e=="function"?e(t):e}function S(e,t){return typeof e=="function"?e(t):e}function le(e){return JSON.stringify(e,(t,s)=>ot(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function jt(e,t){if(e===t)return e;const s=St(e)&&St(t);if(s||ot(e)&&ot(t)){const r=s?e:Object.keys(e),n=r.length,a=s?t:Object.keys(t),l=a.length,c=s?[]:{},d=new Set(r);let g=0;for(let w=0;w<l;w++){const u=s?w:a[w];(!s&&d.has(u)||s)&&e[u]===void 0&&t[u]===void 0?(c[u]=void 0,g++):(c[u]=jt(e[u],t[u]),c[u]===e[u]&&e[u]!==void 0&&g++)}return n===l&&g===n?e:c}return t}function nt(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function St(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ot(e){if(!wt(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!wt(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function wt(e){return Object.prototype.toString.call(e)==="[object Object]"}function Et(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?jt(e,t):t}function kt(e,t){return typeof e=="function"?e(...t):!!e}var T,I,D,Lt,At=(Lt=class extends bt{constructor(){super();p(this,T);p(this,I);p(this,D);h(this,D,t=>{if(!G&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){i(this,I)||this.setEventListener(i(this,D))}onUnsubscribe(){var t;this.hasListeners()||((t=i(this,I))==null||t.call(this),h(this,I,void 0))}setEventListener(t){var s;h(this,D,t),(s=i(this,I))==null||s.call(this),h(this,I,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){i(this,T)!==t&&(h(this,T,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof i(this,T)=="boolean"?i(this,T):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},T=new WeakMap,I=new WeakMap,D=new WeakMap,Lt),Bt=new At,_,x,k,Qt,zt=(Qt=class extends bt{constructor(){super();p(this,_,!0);p(this,x);p(this,k);h(this,k,t=>{if(!G&&window.addEventListener){const s=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){i(this,x)||this.setEventListener(i(this,k))}onUnsubscribe(){var t;this.hasListeners()||((t=i(this,x))==null||t.call(this),h(this,x,void 0))}setEventListener(t){var s;h(this,k,t),(s=i(this,x))==null||s.call(this),h(this,x,t(this.setOnline.bind(this)))}setOnline(t){i(this,_)!==t&&(h(this,_,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return i(this,_)}},_=new WeakMap,x=new WeakMap,k=new WeakMap,Qt),Nt=new zt;function Ct(){let e,t;const s=new Promise((n,a)=>{e=n,t=a});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),e(n)},s.reject=n=>{r({status:"rejected",reason:n}),t(n)},s}function Ht(e){return(e??"online")==="online"?Nt.isOnline():!0}var Vt=e=>setTimeout(e,0);function Wt(){let e=[],t=0,s=c=>{c()},r=c=>{c()},n=Vt;const a=c=>{t?e.push(c):n(()=>{s(c)})},l=()=>{const c=e;e=[],c.length&&n(()=>{r(()=>{c.forEach(d=>{s(d)})})})};return{batch:c=>{let d;t++;try{d=c()}finally{t--,t||l()}return d},batchCalls:c=>(...d)=>{a(()=>{c(...d)})},schedule:a,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{n=c}}}var Ut=Wt();function Kt(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ht(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}var m,o,X,v,j,A,C,L,Y,B,z,U,P,Q,N,f,K,at,ht,ct,ut,lt,ft,dt,Pt,Tt,Jt=(Tt=class extends bt{constructor(t,s){super();p(this,f);p(this,m);p(this,o);p(this,X);p(this,v);p(this,j);p(this,A);p(this,C);p(this,L);p(this,Y);p(this,B);p(this,z);p(this,U);p(this,P);p(this,Q);p(this,N,new Set);this.options=s,h(this,m,t),h(this,L,null),h(this,C,Ct()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,o).addObserver(this),Ft(i(this,o),this.options)?b(this,f,K).call(this):this.updateResult(),b(this,f,ut).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return pt(i(this,o),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return pt(i(this,o),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,b(this,f,lt).call(this),b(this,f,ft).call(this),i(this,o).removeObserver(this)}setOptions(t){const s=this.options,r=i(this,o);if(this.options=i(this,m).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof S(this.options.enabled,i(this,o))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");b(this,f,dt).call(this),i(this,o).setOptions(this.options),s._defaulted&&!nt(this.options,s)&&i(this,m).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,o),observer:this});const n=this.hasListeners();n&&It(i(this,o),r,this.options,s)&&b(this,f,K).call(this),this.updateResult(),n&&(i(this,o)!==r||S(this.options.enabled,i(this,o))!==S(s.enabled,i(this,o))||J(this.options.staleTime,i(this,o))!==J(s.staleTime,i(this,o)))&&b(this,f,at).call(this);const a=b(this,f,ht).call(this);n&&(i(this,o)!==r||S(this.options.enabled,i(this,o))!==S(s.enabled,i(this,o))||a!==i(this,Q))&&b(this,f,ct).call(this,a)}getOptimisticResult(t){const s=i(this,m).getQueryCache().build(i(this,m),t),r=this.createResult(s,t);return Xt(this,r)&&(h(this,v,r),h(this,A,this.options),h(this,j,i(this,o).state)),r}getCurrentResult(){return i(this,v)}trackResult(t,s){return new Proxy(t,{get:(r,n)=>(this.trackProp(n),s==null||s(n),n==="promise"&&!this.options.experimental_prefetchInRender&&i(this,C).status==="pending"&&i(this,C).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(r,n))})}trackProp(t){i(this,N).add(t)}getCurrentQuery(){return i(this,o)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=i(this,m).defaultQueryOptions(t),r=i(this,m).getQueryCache().build(i(this,m),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(t){return b(this,f,K).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,v)))}createResult(t,s){var mt;const r=i(this,o),n=this.options,a=i(this,v),l=i(this,j),c=i(this,A),g=t!==r?t.state:i(this,X),{state:w}=t;let u={...w},H=!1,y;if(s._optimisticResults){const O=this.hasListeners(),$=!O&&Ft(t,s),M=O&&It(t,r,s,n);($||M)&&(u={...u,...Kt(w.data,t.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:V,errorUpdatedAt:W,status:R}=u;y=u.data;let Z=!1;if(s.placeholderData!==void 0&&y===void 0&&R==="pending"){let O;a!=null&&a.isPlaceholderData&&s.placeholderData===(c==null?void 0:c.placeholderData)?(O=a.data,Z=!0):O=typeof s.placeholderData=="function"?s.placeholderData((mt=i(this,z))==null?void 0:mt.state.data,i(this,z)):s.placeholderData,O!==void 0&&(R="success",y=Et(a==null?void 0:a.data,O,s),H=!0)}if(s.select&&y!==void 0&&!Z)if(a&&y===(l==null?void 0:l.data)&&s.select===i(this,Y))y=i(this,B);else try{h(this,Y,s.select),y=s.select(y),y=Et(a==null?void 0:a.data,y,s),h(this,B,y),h(this,L,null)}catch(O){h(this,L,O)}i(this,L)&&(V=i(this,L),y=i(this,B),W=Date.now(),R="error");const tt=u.fetchStatus==="fetching",et=R==="pending",st=R==="error",gt=et&&tt,vt=y!==void 0,E={status:R,fetchStatus:u.fetchStatus,isPending:et,isSuccess:R==="success",isError:st,isInitialLoading:gt,isLoading:gt,data:y,dataUpdatedAt:u.dataUpdatedAt,error:V,errorUpdatedAt:W,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>g.dataUpdateCount||u.errorUpdateCount>g.errorUpdateCount,isFetching:tt,isRefetching:tt&&!et,isLoadingError:st&&!vt,isPaused:u.fetchStatus==="paused",isPlaceholderData:H,isRefetchError:st&&vt,isStale:yt(t,s),refetch:this.refetch,promise:i(this,C),isEnabled:S(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const O=q=>{E.status==="error"?q.reject(E.error):E.data!==void 0&&q.resolve(E.data)},$=()=>{const q=h(this,C,E.promise=Ct());O(q)},M=i(this,C);switch(M.status){case"pending":t.queryHash===r.queryHash&&O(M);break;case"fulfilled":(E.status==="error"||E.data!==M.value)&&$();break;case"rejected":(E.status!=="error"||E.error!==M.reason)&&$();break}}return E}updateResult(){const t=i(this,v),s=this.createResult(i(this,o),this.options);if(h(this,j,i(this,o).state),h(this,A,this.options),i(this,j).data!==void 0&&h(this,z,i(this,o)),nt(s,t))return;h(this,v,s);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,a=typeof n=="function"?n():n;if(a==="all"||!a&&!i(this,N).size)return!0;const l=new Set(a??i(this,N));return this.options.throwOnError&&l.add("error"),Object.keys(i(this,v)).some(c=>{const d=c;return i(this,v)[d]!==t[d]&&l.has(d)})};b(this,f,Pt).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&b(this,f,ut).call(this)}},m=new WeakMap,o=new WeakMap,X=new WeakMap,v=new WeakMap,j=new WeakMap,A=new WeakMap,C=new WeakMap,L=new WeakMap,Y=new WeakMap,B=new WeakMap,z=new WeakMap,U=new WeakMap,P=new WeakMap,Q=new WeakMap,N=new WeakMap,f=new WeakSet,K=function(t){b(this,f,dt).call(this);let s=i(this,o).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(rt)),s},at=function(){b(this,f,lt).call(this);const t=J(this.options.staleTime,i(this,o));if(G||i(this,v).isStale||!Ot(t))return;const r=_t(i(this,v).dataUpdatedAt,t)+1;h(this,U,setTimeout(()=>{i(this,v).isStale||this.updateResult()},r))},ht=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,o)):this.options.refetchInterval)??!1},ct=function(t){b(this,f,ft).call(this),h(this,Q,t),!(G||S(this.options.enabled,i(this,o))===!1||!Ot(i(this,Q))||i(this,Q)===0)&&h(this,P,setInterval(()=>{(this.options.refetchIntervalInBackground||Bt.isFocused())&&b(this,f,K).call(this)},i(this,Q)))},ut=function(){b(this,f,at).call(this),b(this,f,ct).call(this,b(this,f,ht).call(this))},lt=function(){i(this,U)&&(clearTimeout(i(this,U)),h(this,U,void 0))},ft=function(){i(this,P)&&(clearInterval(i(this,P)),h(this,P,void 0))},dt=function(){const t=i(this,m).getQueryCache().build(i(this,m),this.options);if(t===i(this,o))return;const s=i(this,o);h(this,o,t),h(this,X,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},Pt=function(t){Ut.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(i(this,v))}),i(this,m).getQueryCache().notify({query:i(this,o),type:"observerResultsUpdated"})})},Tt);function Gt(e,t){return S(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Ft(e,t){return Gt(e,t)||e.state.data!==void 0&&pt(e,t,t.refetchOnMount)}function pt(e,t,s){if(S(t.enabled,e)!==!1&&J(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&yt(e,t)}return!1}function It(e,t,s,r){return(e!==t||S(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&yt(e,s)}function yt(e,t){return S(t.enabled,e)!==!1&&e.isStaleByTime(J(t.staleTime,e))}function Xt(e,t){return!nt(e.getCurrentResult(),t)}var Mt=F.createContext(!1),Yt=()=>F.useContext(Mt);Mt.Provider;function Zt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var $t=F.createContext(Zt()),qt=()=>F.useContext($t),te=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},ee=e=>{F.useEffect(()=>{e.clearReset()},[e])},se=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(n&&e.data===void 0||kt(s,[e.error,r])),ie=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...r)=>t(s(...r)):t(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},re=(e,t)=>e.isLoading&&e.isFetching&&!t,ne=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,xt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function oe(e,t,s){var u,H,y,V,W;const r=Yt(),n=qt(),a=Dt(s),l=a.defaultQueryOptions(e);(H=(u=a.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||H.call(u,l),l._optimisticResults=r?"isRestoring":"optimistic",ie(l),te(l,n),ee(n);const c=!a.getQueryCache().get(l.queryHash),[d]=F.useState(()=>new t(a,l)),g=d.getOptimisticResult(l),w=!r&&e.subscribed!==!1;if(F.useSyncExternalStore(F.useCallback(R=>{const Z=w?d.subscribe(Ut.batchCalls(R)):rt;return d.updateResult(),Z},[d,w]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),F.useEffect(()=>{d.setOptions(l)},[l,d]),ne(l,g))throw xt(l,d,n);if(se({result:g,errorResetBoundary:n,throwOnError:l.throwOnError,query:a.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw g.error;if((V=(y=a.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||V.call(y,l,g),l.experimental_prefetchInRender&&!G&&re(g,r)){const R=c?xt(l,d,n):(W=a.getQueryCache().get(l.queryHash))==null?void 0:W.promise;R==null||R.catch(rt).finally(()=>{d.updateResult()})}return l.notifyOnChangeProps?g:d.trackResult(g)}function fe(e,t){return oe(e,Jt,t)}export{bt as S,rt as a,kt as b,le as h,Ut as n,nt as s,fe as u};
//# sourceMappingURL=useQuery-Be-wEKB7.js.map
