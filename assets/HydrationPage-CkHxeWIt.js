import{d as te,r as a,e as ie,f as p,j as e,R as W}from"./index-CjnEZlsY.js";import{u as ge}from"./use-toast-1UJezmcI.js";import{A as fe}from"./AIIntelligence-4kibXt-7.js";import{U as je,B as pe}from"./UniformHeader-CjBBS_mR.js";import{C as N,c as _,B as x,d as q,a as ye,b as be}from"./badge-0XDKnG36.js";import{P as ve}from"./progress-B_6640an.js";import{S as A}from"./skeleton-COZohOJG.js";import{D as J,d as K,a as Q,b as S,c as X,P as we}from"./dialog-W3FGrw5O.js";import{C as Ne,a as _e,b as Ce}from"./collapsible-Ch9BGInH.js";import{D as Y}from"./dumbbell-CXPzqEam.js";import{C as ke,F as Me}from"./footprints-By0Qs2Nw.js";import{T as De}from"./trophy-CS6fcHcf.js";import{Z as U}from"./zap-BxpV5bJv.js";import{S as ee}from"./shield-BlXCgQw2.js";import{C as ae}from"./clock-Dl80stQh.js";import{I as Ee}from"./info-Cl4o18K4.js";import{M as Te}from"./minus-B_EWRt-2.js";import{T as ze}from"./trending-up-Cmv-0pKX.js";import{u as Re,C as se,B as $e}from"./chunk-PVWAREVJ-1IT8eIKF.js";import"./index-GGMoTRFm.js";import"./user-BtYr8gLe.js";import"./clsx-B-dksMZM.js";import"./index-DdwsCUG1.js";import"./index-QD0cdno-.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],z=te("droplets",Le);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],qe=te("thermometer",Pe),Ae=({pillar:y,onUpdate:s,onInsert:n,onDelete:d})=>{const u=a.useRef(null),{appStoreUser:m}=ie();return a.useEffect(()=>{if(!(m!=null&&m.id))return;const R={hydration:"hydration_logs",nutrition:"meals",sleep:"sleep_sessions",workout:"workout_sessions"}[y],M=`${y}-${m.id}`;return u.current=p.channel(M).on("postgres_changes",{event:"*",schema:"public",table:R,filter:`user_id=eq.${m.id}`},l=>{var $,D;console.log(`üì° Realtime update for ${y}:`,l);const b={...l,userId:(($=l.new)==null?void 0:$.user_id)||((D=l.old)==null?void 0:D.user_id)};switch(l.eventType){case"INSERT":n==null||n(b),s==null||s(b);break;case"UPDATE":s==null||s(b);break;case"DELETE":d==null||d(b),s==null||s(b);break}}).subscribe(),()=>{u.current&&p.removeChannel(u.current)}},[m==null?void 0:m.id,y,s,n,d]),{isConnected:!!u.current}},Ie={endurance:{emoji:"üèÉ‚Äç‚ôÇÔ∏è",goalModifierMl:1e3,contextualReminder:"Hydratez-vous toutes les 15-20 minutes pendant l'effort pour maintenir vos performances.",recommendedDrink:{type:"sports_drink",name:"Boisson Sport",icon:U,amount:250,color:"bg-orange-500"},tips:[{icon:Me,title:"Pr√©-hydratation",description:"Buvez 500ml 2-3h avant l'effort et 250ml 15min avant le d√©part.",priority:"high"},{icon:ae,title:"Pendant l'effort",description:"150-250ml toutes les 15-20min selon l'intensit√© et la temp√©rature.",priority:"high"},{icon:qe,title:"Post-effort",description:"Buvez 150% du poids perdu en sueur dans les 6h suivant l'effort.",priority:"medium"}]},contact:{emoji:"üèà",goalModifierMl:750,contextualReminder:"Compensez les pertes intenses en sels min√©raux avec des √©lectrolytes.",recommendedDrink:{type:"electrolytes",name:"√âlectrolytes",icon:ee,amount:500,color:"bg-purple-500"},tips:[{icon:ee,title:"√âlectrolytes cruciaux",description:"La sueur sous l'√©quipement fait perdre beaucoup de sodium. Compensez avec des boissons enrichies.",priority:"high"},{icon:Y,title:"R√©cup√©ration acc√©l√©r√©e",description:"Une hydratation optimale r√©duit les courbatures et acc√©l√®re la r√©paration musculaire.",priority:"medium"}]},court:{emoji:"üéæ",goalModifierMl:500,contextualReminder:"Profitez de chaque pause pour boire 150-200ml et maintenir votre niveau.",recommendedDrink:{type:"water",name:"Eau Pure",icon:z,amount:250,color:"bg-blue-500"},tips:[{icon:De,title:"Concentration optimale",description:"M√™me 2% de d√©shydratation r√©duit significativement vos r√©flexes et votre pr√©cision.",priority:"high"},{icon:U,title:"√ânergie constante",description:"Pour les matchs >1h, alternez eau pure et boisson isotonique toutes les 2 pauses.",priority:"medium"}]},strength:{emoji:"üí™",goalModifierMl:250,contextualReminder:"Hydratez-vous entre chaque s√©rie pour maintenir force et concentration.",recommendedDrink:{type:"water",name:"Eau Fra√Æche",icon:z,amount:300,color:"bg-blue-600"},tips:[{icon:Y,title:"Performance musculaire",description:"3% de d√©shydratation = 10-15% de perte de force. Hydratez-vous r√©guli√®rement.",priority:"high"},{icon:ke,title:"Pr√©-workout et caf√©ine",description:"Si vous prenez des stimulants, augmentez votre apport hydrique de 500ml.",priority:"medium"}]}},ds=()=>{const y=Re(),{appStoreUser:s}=ie(),{toast:n}=ge(),[d,u]=a.useState(0),[m,I]=a.useState(250),[R,M]=a.useState(!0),[l,b]=a.useState([]),[$,D]=a.useState(null),[C,B]=a.useState(null),[H,re]=a.useState(!1),[ne,le]=a.useState(!1),[oe,ce]=a.useState(!1),k=new Date().toISOString().split("T")[0],E=a.useCallback(t=>({basketball:"court",tennis:"court",volleyball:"court",badminton:"court",american_football:"contact",rugby:"contact",hockey:"contact",football:"endurance",running:"endurance",cycling:"endurance",swimming:"endurance",triathlon:"endurance","course √† pied":"endurance",musculation:"strength",powerlifting:"strength",crossfit:"strength",weightlifting:"strength"})[(t==null?void 0:t.toLowerCase())||""]||"strength",[])(s==null?void 0:s.sport),r=Ie[E],h=a.useMemo(()=>{var g,f;const o=((s==null?void 0:s.weight)??70)*35;let i=0;i+=r.goalModifierMl,s!=null&&s.age&&(s.age>50&&(i+=200),s.age<25&&(i+=300)),(s==null?void 0:s.gender)==="male"&&(i+=300),(g=s==null?void 0:s.primary_goals)!=null&&g.includes("weight_loss")&&(i+=500),(f=s==null?void 0:s.primary_goals)!=null&&f.includes("muscle_gain")&&(i+=300);const c=s==null?void 0:s.activity_level;return c==="extra_active"?i+=500:c==="moderately_active"&&(i+=300),Math.round(o+i)},[s,r.goalModifierMl]),v=a.useCallback(async()=>{if(s!=null&&s.id)try{M(!0);const t=new Date().toISOString().split("T")[0],{data:o,error:i}=await p.from("daily_stats").select("*").eq("user_id",s.id).eq("stat_date",t).single(),{data:c,error:g}=await p.from("hydration_logs").select("*").eq("user_id",s.id).eq("log_date",t).order("logged_at",{ascending:!1});i&&i.code!=="PGRST116"&&(console.error("Error fetching daily stats:",i),n({title:"Erreur de chargement des stats",variant:"destructive"})),g&&(console.error("Error fetching hydration logs:",g),n({title:"Erreur de chargement des logs",variant:"destructive"}));const f=o,w=c;D(f),b(w||[]),u(f?f.water_intake_ml??0:0),w&&w.length>0&&B(new Date(w[0].logged_at))}catch{console.error("Erreur chargement hydratation:",error),n({title:"Erreur inattendue",description:"Impossible de charger les donn√©es d'hydratation.",variant:"destructive"})}finally{M(!1)}},[s==null?void 0:s.id,n]),O=a.useCallback(async(t,o="water",i="normal")=>{if(s!=null&&s.id)try{const c=d+t,g=new Date;u(c),B(g);const{error:f}=await p.from("hydration_logs").insert({user_id:s.id,amount_ml:t,drink_type:o,logged_at:g.toISOString(),log_date:k,hydration_context:i});if(f)throw f;const{error:w}=await p.from("daily_stats").upsert({user_id:s.id,stat_date:k,water_intake_ml:c,hydration_goal_ml:h,updated_at:g.toISOString()},{onConflict:"user_id,stat_date"});if(w)throw w;const P=s.first_name||s.username||"Champion",Z=c/h*100;let T=`+${t}ml ajout√©s ! `;Z>=100?T+=`üéâ Objectif atteint ${P} !`:Z>=75?T+=`üí™ Excellent ${P}, presque fini !`:T+=`Continue ${P} !`,n({title:"Hydratation ajout√©e",description:T}),await v()}catch{console.error("Erreur ajout hydratation:",error),u(c=>c-t),n({title:"Erreur",description:"Impossible de sauvegarder. R√©essayez.",variant:"destructive"})}},[s==null?void 0:s.id,d,h,k,v,n]),de=a.useCallback(async()=>{if(l.length===0)return;const t=l[0],o=d-t.amount_ml;try{u(o);const{error:i}=await p.from("hydration_logs").delete().eq("id",t.id);if(i)throw i;const{error:c}=await p.from("daily_stats").upsert({user_id:s==null?void 0:s.id,stat_date:k,water_intake_ml:o,hydration_goal_ml:h,updated_at:new Date().toISOString()});if(c)throw c;n({title:"Derni√®re entr√©e supprim√©e",description:`-${t.amount_ml}ml`}),await v()}catch{console.error("Erreur suppression:",error),u(i=>i+t.amount_ml),n({title:"Erreur",description:"Impossible de supprimer l'entr√©e",variant:"destructive"})}},[l,d,s==null?void 0:s.id,h,k,v,n]);Ae({pillar:"hydration",onUpdate:t=>{t.userId!==(s==null?void 0:s.id)&&(t.eventType==="INSERT"||t.eventType==="UPDATE")&&v()}});const me=d/1e3,F=h/1e3,G=Math.max(0,h-d),j=h>0?Math.min(d/h*100,100):0,V=j>=100,ue=a.useCallback(()=>{const t=(s==null?void 0:s.first_name)||(s==null?void 0:s.username)||"Champion";return V?`üéâ Excellent ${t} ! Objectif atteint !`:j>=75?`üí™ Bravo ${t}, tu y es presque !`:j>=50?`‚ö° Continue ${t} !`:`üíß ${t}, hydrate-toi !`},[j,V,s]),he=a.useCallback(()=>r.tips.filter(o=>o.priority==="high")[0]||r.tips[0],[r.tips]),xe=a.useCallback(()=>j<80&&(!C||new Date().getTime()-C.getTime()>2*60*60*1e3),[j,C]);if(a.useEffect(()=>{v()},[v]),R)return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"px-4 py-6 space-y-6 max-w-2xl mx-auto",children:[e.jsx(A,{className:"h-20 w-full"}),e.jsx(A,{className:"h-32 w-full"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:4}).map((t,o)=>e.jsx(A,{className:"h-20"},o))})]})});const L=he();return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"px-4 py-6 space-y-6 max-w-2xl mx-auto",children:[e.jsx(je,{title:"Hydratation",subtitle:`${r.emoji} ${ue()}`,showBackButton:!0,showSettings:!0,showNotifications:!0,showProfile:!0,gradient:!0}),e.jsx(N,{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white",children:e.jsxs(_,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center space-x-2",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"Aujourd'hui"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>re(!H),className:"text-white hover:bg-white/20",children:e.jsx(pe,{className:`h-4 w-4 ${H?"fill-current":""}`})}),e.jsxs(J,{open:oe,onOpenChange:ce,children:[e.jsx(K,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",children:e.jsx(Ee,{className:"h-4 w-4"})})}),e.jsxs(Q,{className:"max-w-md",children:[e.jsx(S,{children:e.jsx(X,{children:"D√©tails de votre objectif"})}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:["En tant que ",(s==null?void 0:s.gender)==="male"?"homme":"femme"," de"," ",(s==null?void 0:s.age)||"?"," ans (",(s==null?void 0:s.weight)||"?","kg) pratiquant le ",(s==null?void 0:s.sport)||"sport",", votre objectif de"," ",F.toFixed(1),"L est adapt√© √† vos besoins."]}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsxs("p",{children:["‚Ä¢ Base: ",Math.round(((s==null?void 0:s.weight)||70)*35),"ml (35ml/kg)"]}),e.jsxs("p",{children:["‚Ä¢ Bonus sport ",E,": +",r.goalModifierMl,"ml"]}),e.jsxs("p",{children:["‚Ä¢ Ajustements profil: +",h-Math.round(((s==null?void 0:s.weight)||70)*35)-r.goalModifierMl,"ml"]})]})]})]})]})]})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:"text-4xl font-bold mb-1",children:[me.toFixed(2).replace(/\.?0+$/,""),"L"]}),e.jsxs("div",{className:"text-white/80",children:["sur ",F.toFixed(2).replace(/\.?0+$/,""),"L"]}),e.jsxs(q,{variant:"secondary",className:"mt-1 bg-white/20 text-white border-white/30",children:["Objectif ",E," ",r.emoji]}),e.jsx("div",{className:"text-sm text-white/70 mt-2",children:G>0?`${(G/1e3).toFixed(2).replace(/\.?0+$/,"")}L restants`:"Objectif atteint ! üéâ"})]}),e.jsx(ve,{value:j,className:"h-3 mb-4 bg-white/20"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-white/90",children:[Math.round(j),"% compl√©t√©"]}),C&&e.jsxs("span",{className:"text-white/70",children:["Dernier:"," ",C.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:e.jsx(N,{children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"flex space-x-2 mb-4",children:[150,250,350,500].map(t=>e.jsxs(x,{variant:m===t?"default":"outline",size:"sm",onClick:()=>I(t),className:"flex-1",children:[t,"ml"]},t))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(x,{onClick:()=>O(m,"water","normal"),size:"lg",className:"bg-blue-600 hover:bg-blue-700 h-16 flex flex-col space-y-1",children:[e.jsx(we,{size:20}),e.jsxs("span",{className:"text-sm",children:["Eau ",m,"ml"]})]}),e.jsxs(x,{onClick:()=>O(r.recommendedDrink.amount,r.recommendedDrink.type,"workout"),size:"lg",variant:"outline",className:`h-16 flex flex-col space-y-1 border-2 ${r.recommendedDrink.color.replace("bg-","border-")} hover:${r.recommendedDrink.color.replace("bg-","bg-")}/10`,children:[W.createElement(r.recommendedDrink.icon,{size:20}),e.jsx("span",{className:"text-sm",children:r.recommendedDrink.name})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[e.jsxs(x,{onClick:de,variant:"outline",size:"sm",disabled:l.length===0,className:"flex items-center space-x-2",children:[e.jsx(Te,{size:16}),e.jsx("span",{children:"Annuler"})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>y("/hydration/history"),className:"flex items-center space-x-2",children:[e.jsx(ze,{size:16}),e.jsx("span",{children:"Historique"})]})]})]})})}),l.length>0&&e.jsxs(N,{children:[e.jsx(ye,{className:"pb-2",children:e.jsxs(be,{className:"text-sm flex items-center justify-between",children:[e.jsx("span",{children:"Aujourd'hui"}),e.jsxs(q,{variant:"outline",children:[l.length," entr√©es"]})]})}),e.jsxs(_,{className:"p-4 pt-0",children:[e.jsx("div",{className:"space-y-2",children:l.slice(0,3).map(t=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-3 w-3 text-blue-500"}),e.jsxs("span",{children:[t.amount_ml,"ml"]}),e.jsx(q,{variant:"outline",className:"text-xs",children:t.drink_type})]}),e.jsx("span",{className:"text-gray-500",children:new Date(t.logged_at).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]},t.id))}),l.length>3&&e.jsxs(x,{variant:"ghost",size:"sm",className:"w-full mt-2 text-xs",onClick:()=>y("/hydration/history"),children:["Voir les ",l.length-3," autres entr√©es"]})]})]}),e.jsx(N,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[W.createElement(L.icon,{size:20,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800 text-sm mb-1",children:L.title}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:L.description}),e.jsxs(Ne,{children:[e.jsx(_e,{asChild:!0,children:e.jsxs(x,{variant:"ghost",size:"sm",className:"text-xs p-0 h-auto",children:["Voir tous les conseils ",e.jsx(se,{className:"h-3 w-3 ml-1"})]})}),e.jsx(Ce,{className:"mt-3 space-y-2",children:r.tips.slice(1).map((t,o)=>{const i=t.icon;return e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(i,{size:16,className:"text-gray-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 text-xs mb-1",children:t.title}),e.jsx("p",{className:"text-xs text-gray-600",children:t.description})]})]})},o)})})]})]})]})})}),xe()&&e.jsx(N,{className:"bg-blue-50 border-blue-100",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ae,{size:18,className:"text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-blue-800 text-sm mb-1",children:["Rappel ",E," ",r.emoji]}),e.jsx("p",{className:"text-blue-700 text-xs",children:r.contextualReminder})]})]})})}),e.jsx(N,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($e,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Coaching IA"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Analyse personnalis√©e et conseils"})]})]}),e.jsxs(J,{open:ne,onOpenChange:le,children:[e.jsx(K,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",children:["Ouvrir ",e.jsx(se,{className:"h-3 w-3 ml-1"})]})}),e.jsxs(Q,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(S,{children:e.jsx(X,{children:"Coaching IA - Hydratation"})}),e.jsx(fe,{pillar:"hydration",showPredictions:!0,showCoaching:!0,showRecommendations:!0})]})]})]})})})]})})};export{ds as default};
//# sourceMappingURL=HydrationPage-CkHxeWIt.js.map
